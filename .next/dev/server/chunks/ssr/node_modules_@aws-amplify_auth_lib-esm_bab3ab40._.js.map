{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/types/Auth.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/types/Auth.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n\tICookieStorageData,\n\tICognitoStorage,\n} from 'amazon-cognito-identity-js';\n\n/**\n * Parameters for user sign up\n */\nexport interface SignUpParams {\n\tusername: string;\n\tpassword: string;\n\tattributes?: object;\n\tvalidationData?: { [key: string]: any };\n\tclientMetadata?: { [key: string]: string };\n\tautoSignIn?: AutoSignInOptions;\n}\n\nexport interface AuthCache {\n\tsetItem();\n\tgetItem();\n\tremoveItem();\n}\n\n/**\n * Auth instance options\n */\nexport interface AuthOptions {\n\tuserPoolId?: string;\n\tuserPoolWebClientId?: string;\n\tidentityPoolId?: string;\n\tregion?: string;\n\tmandatorySignIn?: boolean;\n\tcookieStorage?: ICookieStorageData;\n\toauth?: OAuthOpts;\n\trefreshHandlers?: object;\n\tstorage?: ICognitoStorage;\n\tauthenticationFlowType?: string;\n\tidentityPoolRegion?: string;\n\tclientMetadata?: any;\n\tendpoint?: string;\n\tsignUpVerificationMethod?: 'code' | 'link';\n}\n\nexport enum CognitoHostedUIIdentityProvider {\n\tCognito = 'COGNITO',\n\tGoogle = 'Google',\n\tFacebook = 'Facebook',\n\tAmazon = 'LoginWithAmazon',\n\tApple = 'SignInWithApple',\n}\n\nexport type LegacyProvider =\n\t| 'google'\n\t| 'facebook'\n\t| 'amazon'\n\t| 'developer'\n\t| string;\n\nexport type FederatedSignInOptions = {\n\tprovider: CognitoHostedUIIdentityProvider;\n\tcustomState?: string;\n};\n\nexport type FederatedSignInOptionsCustom = {\n\tcustomProvider: string;\n\tcustomState?: string;\n};\n\nexport function isFederatedSignInOptions(\n\tobj: any\n): obj is FederatedSignInOptions {\n\tconst keys: (keyof FederatedSignInOptions)[] = ['provider'];\n\treturn obj && !!keys.find(k => obj.hasOwnProperty(k));\n}\n\nexport function isFederatedSignInOptionsCustom(\n\tobj: any\n): obj is FederatedSignInOptionsCustom {\n\tconst keys: (keyof FederatedSignInOptionsCustom)[] = ['customProvider'];\n\treturn obj && !!keys.find(k => obj.hasOwnProperty(k));\n}\n\nexport function hasCustomState(obj: any): boolean {\n\tconst keys: (keyof (\n\t\t| FederatedSignInOptions\n\t\t| FederatedSignInOptionsCustom\n\t))[] = ['customState'];\n\treturn obj && !!keys.find(k => obj.hasOwnProperty(k));\n}\n\n/**\n * Details for multi-factor authentication\n */\nexport interface MfaRequiredDetails {\n\tchallengeName: any;\n\tchallengeParameters: any;\n}\n\n/**\n * interface for federatedResponse\n */\nexport interface FederatedResponse {\n\t// access token\n\ttoken: string;\n\t// identity id\n\tidentity_id?: string;\n\t// the universal time when token expired\n\texpires_at: number;\n}\n\n/**\n * interface for federatedUser\n */\nexport interface FederatedUser {\n\tname: string;\n\temail?: string;\n\tpicture?: string;\n}\n\nexport interface AwsCognitoOAuthOpts {\n\tdomain: string;\n\tscope: Array<string>;\n\tredirectSignIn: string;\n\tredirectSignOut: string;\n\tresponseType: string;\n\toptions?: object;\n\turlOpener?: (url: string, redirectUrl: string) => Promise<any>;\n}\n\nexport function isCognitoHostedOpts(\n\toauth: OAuthOpts\n): oauth is AwsCognitoOAuthOpts {\n\treturn (<AwsCognitoOAuthOpts>oauth).redirectSignIn !== undefined;\n}\n\nexport interface Auth0OAuthOpts {\n\tdomain: string;\n\tclientID: string;\n\tscope: string;\n\tredirectUri: string;\n\taudience: string;\n\tresponseType: string;\n\treturnTo: string;\n\turlOpener?: (url: string, redirectUrl: string) => Promise<any>;\n}\n\n// Replacing to fix typings\n// export interface OAuth {\n//     awsCognito?: awsCognitoOAuthOpts,\n//     auth0?: any\n// }\n\nexport type OAuthOpts = AwsCognitoOAuthOpts | Auth0OAuthOpts;\n\nexport interface ConfirmSignUpOptions {\n\tforceAliasCreation?: boolean;\n\tclientMetadata?: ClientMetaData;\n}\n\nexport interface SignOutOpts {\n\tglobal?: boolean;\n}\n\nexport interface CurrentUserOpts {\n\tbypassCache: boolean;\n}\n\nexport interface GetPreferredMFAOpts {\n\tbypassCache: boolean;\n}\n\nexport type UsernamePasswordOpts = {\n\tusername: string;\n\tpassword: string;\n\tvalidationData?: { [key: string]: any };\n};\n\nexport enum AuthErrorTypes {\n\tNoConfig = 'noConfig',\n\tMissingAuthConfig = 'missingAuthConfig',\n\tEmptyUsername = 'emptyUsername',\n\tInvalidUsername = 'invalidUsername',\n\tEmptyPassword = 'emptyPassword',\n\tEmptyCode = 'emptyCode',\n\tSignUpError = 'signUpError',\n\tNoMFA = 'noMFA',\n\tInvalidMFA = 'invalidMFA',\n\tEmptyChallengeResponse = 'emptyChallengeResponse',\n\tNoUserSession = 'noUserSession',\n\tDefault = 'default',\n\tDeviceConfig = 'deviceConfig',\n\tNetworkError = 'networkError',\n\tAutoSignInError = 'autoSignInError',\n}\n\nexport type AuthErrorMessages = { [key in AuthErrorTypes]: AuthErrorMessage };\n\nexport interface AuthErrorMessage {\n\tmessage: string;\n\tlog?: string;\n}\n\n// We can extend this in the future if needed\nexport type SignInOpts = UsernamePasswordOpts;\n\nexport type ClientMetaData =\n\t| {\n\t\t\t[key: string]: string;\n\t  }\n\t| undefined;\n\nexport function isUsernamePasswordOpts(obj: any): obj is UsernamePasswordOpts {\n\treturn !!(obj as UsernamePasswordOpts).username;\n}\n\nexport interface IAuthDevice {\n\tid: string;\n\tname: string;\n}\n\nexport interface AutoSignInOptions {\n\tenabled: boolean;\n\tclientMetaData?: ClientMetaData;\n\tvalidationData?: { [key: string]: any };\n}\n\nexport enum GRAPHQL_AUTH_MODE {\n\tAPI_KEY = 'API_KEY',\n\tAWS_IAM = 'AWS_IAM',\n\tOPENID_CONNECT = 'OPENID_CONNECT',\n\tAMAZON_COGNITO_USER_POOLS = 'AMAZON_COGNITO_USER_POOLS',\n\tAWS_LAMBDA = 'AWS_LAMBDA',\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 92, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/OAuth/urlOpener.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/OAuth/urlOpener.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nconst SELF = '_self';\n\nexport const launchUri = (url: string) => {\n\tconst windowProxy = window.open(url, SELF);\n\tif (windowProxy) {\n\t\treturn Promise.resolve(windowProxy);\n\t} else {\n\t\treturn Promise.reject();\n\t}\n};\n"],"names":[],"mappings":";;;;AAAA,qEAAqE;AACrE,sCAAsC;AAEtC,IAAM,IAAI,GAAG,OAAO,CAAC;AAEd,IAAM,SAAS,GAAG,SAAC,GAAW;IACpC,IAAM,WAAW,GAAG,MAAM,CAAC,IAAI,CAAC,GAAG,EAAE,IAAI,CAAC,CAAC;IAC3C,IAAI,WAAW,EAAE;QAChB,OAAO,OAAO,CAAC,OAAO,CAAC,WAAW,CAAC,CAAC;KACpC,MAAM;QACN,OAAO,OAAO,CAAC,MAAM,EAAE,CAAC;KACxB;AACF,CAAC,CAAC"}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/OAuth/oauthStorage.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/OAuth/oauthStorage.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nexport const setState = (state: string) => {\n\twindow.sessionStorage.setItem('oauth_state', state);\n};\n\nexport const getState = () => {\n\tconst oauth_state = window.sessionStorage.getItem('oauth_state');\n\twindow.sessionStorage.removeItem('oauth_state');\n\treturn oauth_state;\n};\n\nexport const setPKCE = (private_key: string) => {\n\twindow.sessionStorage.setItem('ouath_pkce_key', private_key);\n};\n\nexport const getPKCE = () => {\n\tconst ouath_pkce_key = window.sessionStorage.getItem('ouath_pkce_key');\n\twindow.sessionStorage.removeItem('ouath_pkce_key');\n\treturn ouath_pkce_key;\n};\n\nexport const clearAll = () => {\n\twindow.sessionStorage.removeItem('ouath_pkce_key');\n\twindow.sessionStorage.removeItem('oauth_state');\n};\n"],"names":[],"mappings":"AAAA,qEAAqE;AACrE,sCAAsC;;;;;;;;;;;;;AAE/B,IAAM,QAAQ,GAAG,SAAC,KAAa;IACrC,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,aAAa,EAAE,KAAK,CAAC,CAAC;AACrD,CAAC,CAAC;AAEK,IAAM,QAAQ,GAAG;IACvB,IAAM,WAAW,GAAG,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,aAAa,CAAC,CAAC;IACjE,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;IAChD,OAAO,WAAW,CAAC;AACpB,CAAC,CAAC;AAEK,IAAM,OAAO,GAAG,SAAC,WAAmB;IAC1C,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,gBAAgB,EAAE,WAAW,CAAC,CAAC;AAC9D,CAAC,CAAC;AAEK,IAAM,OAAO,GAAG;IACtB,IAAM,cAAc,GAAG,MAAM,CAAC,cAAc,CAAC,OAAO,CAAC,gBAAgB,CAAC,CAAC;IACvE,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,gBAAgB,CAAC,CAAC;IACnD,OAAO,cAAc,CAAC;AACvB,CAAC,CAAC;AAEK,IAAM,QAAQ,GAAG;IACvB,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,gBAAgB,CAAC,CAAC;IACnD,MAAM,CAAC,cAAc,CAAC,UAAU,CAAC,aAAa,CAAC,CAAC;AACjD,CAAC,CAAC"}},
    {"offset": {"line": 149, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/OAuth/OAuth.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/OAuth/OAuth.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { parse } from 'url'; // Used for OAuth parsing of Cognito Hosted UI\nimport { launchUri } from './urlOpener';\nimport * as oAuthStorage from './oauthStorage';\nimport { Buffer } from 'buffer';\n\nimport {\n\tOAuthOpts,\n\tisCognitoHostedOpts,\n\tCognitoHostedUIIdentityProvider,\n} from '../types/Auth';\n\nimport {\n\tAuthAction,\n\tCategory,\n\tConsoleLogger as Logger,\n\tCustomUserAgentDetails,\n\tgetAmplifyUserAgent,\n\tHub,\n\turlSafeEncode,\n\tUSER_AGENT_HEADER,\n} from '@aws-amplify/core';\n\nimport { Sha256 } from '@aws-crypto/sha256-js';\n\nconst AMPLIFY_SYMBOL = (\n\ttypeof Symbol !== 'undefined' && typeof Symbol.for === 'function'\n\t\t? Symbol.for('amplify_default')\n\t\t: '@@amplify_default'\n) as Symbol;\n\nconst dispatchAuthEvent = (event: string, data: any, message: string) => {\n\tHub.dispatch('auth', { event, data, message }, 'Auth', AMPLIFY_SYMBOL);\n};\n\nconst logger = new Logger('OAuth');\n\nexport default class OAuth {\n\tprivate _urlOpener;\n\tprivate _config;\n\tprivate _cognitoClientId;\n\tprivate _scopes;\n\n\tconstructor({\n\t\tconfig,\n\t\tcognitoClientId,\n\t\tscopes = [],\n\t}: {\n\t\tscopes: string[];\n\t\tconfig: OAuthOpts;\n\t\tcognitoClientId: string;\n\t}) {\n\t\tthis._urlOpener = config.urlOpener || launchUri;\n\t\tthis._config = config;\n\t\tthis._cognitoClientId = cognitoClientId;\n\n\t\tif (!this.isValidScopes(scopes))\n\t\t\tthrow Error('scopes must be a String Array');\n\t\tthis._scopes = scopes;\n\t}\n\n\tprivate isValidScopes(scopes: string[]) {\n\t\treturn (\n\t\t\tArray.isArray(scopes) && scopes.every(scope => typeof scope === 'string')\n\t\t);\n\t}\n\n\tpublic oauthSignIn(\n\t\tresponseType = 'code',\n\t\tdomain: string,\n\t\tredirectSignIn: string,\n\t\tclientId: string,\n\t\tprovider:\n\t\t\t| CognitoHostedUIIdentityProvider\n\t\t\t| string = CognitoHostedUIIdentityProvider.Cognito,\n\t\tcustomState?: string\n\t) {\n\t\tconst generatedState = this._generateState(32);\n\n\t\t/* encodeURIComponent is not URL safe, use urlSafeEncode instead. Cognito \n\t\tsingle-encodes/decodes url on first sign in and double-encodes/decodes url\n\t\twhen user already signed in. Using encodeURIComponent, Base32, Base64 add \n\t\tcharacters % or = which on further encoding becomes unsafe. '=' create issue \n\t\tfor parsing query params. \n\t\tRefer: https://github.com/aws-amplify/amplify-js/issues/5218 */\n\t\tconst state = customState\n\t\t\t? `${generatedState}-${urlSafeEncode(customState)}`\n\t\t\t: generatedState;\n\n\t\toAuthStorage.setState(state);\n\n\t\tconst pkce_key = this._generateRandom(128);\n\t\toAuthStorage.setPKCE(pkce_key);\n\n\t\tconst code_challenge = this._generateChallenge(pkce_key);\n\t\tconst code_challenge_method = 'S256';\n\n\t\tconst scopesString = this._scopes.join(' ');\n\n\t\tconst queryString = Object.entries({\n\t\t\tredirect_uri: redirectSignIn,\n\t\t\tresponse_type: responseType,\n\t\t\tclient_id: clientId,\n\t\t\tidentity_provider: provider,\n\t\t\tscope: scopesString,\n\t\t\tstate,\n\t\t\t...(responseType === 'code' ? { code_challenge } : {}),\n\t\t\t...(responseType === 'code' ? { code_challenge_method } : {}),\n\t\t})\n\t\t\t.map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n\t\t\t.join('&');\n\n\t\tconst URL = `https://${domain}/oauth2/authorize?${queryString}`;\n\t\tlogger.debug(`Redirecting to ${URL}`);\n\t\tthis._urlOpener(URL, redirectSignIn);\n\t}\n\n\tprivate async _handleCodeFlow(currentUrl: string) {\n\t\t/* Convert URL into an object with parameters as keys\n    { redirect_uri: 'http://localhost:3000/', response_type: 'code', ...} */\n\t\tconst { code } = (parse(currentUrl).query || '')\n\t\t\t.split('&')\n\t\t\t.map(pairings => pairings.split('='))\n\t\t\t.reduce((accum, [k, v]) => ({ ...accum, [k]: v }), { code: undefined });\n\n\t\tconst currentUrlPathname = parse(currentUrl).pathname || '/';\n\t\tconst redirectSignInPathname =\n\t\t\tparse(this._config.redirectSignIn).pathname || '/';\n\n\t\tif (!code || currentUrlPathname !== redirectSignInPathname) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst oAuthTokenEndpoint =\n\t\t\t'https://' + this._config.domain + '/oauth2/token';\n\n\t\tdispatchAuthEvent(\n\t\t\t'codeFlow',\n\t\t\t{},\n\t\t\t`Retrieving tokens from ${oAuthTokenEndpoint}`\n\t\t);\n\n\t\tconst client_id = isCognitoHostedOpts(this._config)\n\t\t\t? this._cognitoClientId\n\t\t\t: this._config.clientID;\n\n\t\tconst redirect_uri = isCognitoHostedOpts(this._config)\n\t\t\t? this._config.redirectSignIn\n\t\t\t: this._config.redirectUri;\n\n\t\tconst code_verifier = oAuthStorage.getPKCE();\n\n\t\tconst oAuthTokenBody = {\n\t\t\tgrant_type: 'authorization_code',\n\t\t\tcode,\n\t\t\tclient_id,\n\t\t\tredirect_uri,\n\t\t\t...(code_verifier ? { code_verifier } : {}),\n\t\t};\n\n\t\tlogger.debug(\n\t\t\t`Calling token endpoint: ${oAuthTokenEndpoint} with`,\n\t\t\toAuthTokenBody\n\t\t);\n\n\t\tconst body = Object.entries(oAuthTokenBody)\n\t\t\t.map(([k, v]) => `${encodeURIComponent(k)}=${encodeURIComponent(v)}`)\n\t\t\t.join('&');\n\n\t\tconst customUserAgentDetails: CustomUserAgentDetails = {\n\t\t\tcategory: Category.Auth,\n\t\t\taction: AuthAction.FederatedSignIn,\n\t\t};\n\n\t\tconst { access_token, refresh_token, id_token, error } = await (\n\t\t\t(await fetch(oAuthTokenEndpoint, {\n\t\t\t\tmethod: 'POST',\n\t\t\t\theaders: {\n\t\t\t\t\t'Content-Type': 'application/x-www-form-urlencoded',\n\t\t\t\t\t[USER_AGENT_HEADER]: getAmplifyUserAgent(customUserAgentDetails),\n\t\t\t\t},\n\t\t\t\tbody,\n\t\t\t})) as any\n\t\t).json();\n\n\t\tif (error) {\n\t\t\tthrow new Error(error);\n\t\t}\n\n\t\treturn {\n\t\t\taccessToken: access_token,\n\t\t\trefreshToken: refresh_token,\n\t\t\tidToken: id_token,\n\t\t};\n\t}\n\n\tprivate async _handleImplicitFlow(currentUrl: string) {\n\t\t// hash is `null` if `#` doesn't exist on URL\n\t\tconst { id_token, access_token } = (parse(currentUrl).hash || '#')\n\t\t\t.substr(1) // Remove # from returned code\n\t\t\t.split('&')\n\t\t\t.map(pairings => pairings.split('='))\n\t\t\t.reduce((accum, [k, v]) => ({ ...accum, [k]: v }), {\n\t\t\t\tid_token: undefined,\n\t\t\t\taccess_token: undefined,\n\t\t\t});\n\n\t\tdispatchAuthEvent('implicitFlow', {}, `Got tokens from ${currentUrl}`);\n\t\tlogger.debug(`Retrieving implicit tokens from ${currentUrl} with`);\n\n\t\treturn {\n\t\t\taccessToken: access_token,\n\t\t\tidToken: id_token,\n\t\t\trefreshToken: null,\n\t\t};\n\t}\n\n\tpublic async handleAuthResponse(currentUrl?: string) {\n\t\ttry {\n\t\t\tconst urlParams = currentUrl\n\t\t\t\t? ({\n\t\t\t\t\t\t...(parse(currentUrl).hash || '#')\n\t\t\t\t\t\t\t.substr(1)\n\t\t\t\t\t\t\t.split('&')\n\t\t\t\t\t\t\t.map(entry => entry.split('='))\n\t\t\t\t\t\t\t.reduce((acc, [k, v]) => ((acc[k] = v), acc), {}),\n\t\t\t\t\t\t...(parse(currentUrl).query || '')\n\t\t\t\t\t\t\t.split('&')\n\t\t\t\t\t\t\t.map(entry => entry.split('='))\n\t\t\t\t\t\t\t.reduce((acc, [k, v]) => ((acc[k] = v), acc), {}),\n\t\t\t\t  } as any)\n\t\t\t\t: {};\n\t\t\tconst { error, error_description } = urlParams;\n\n\t\t\tif (error) {\n\t\t\t\tthrow new Error(error_description);\n\t\t\t}\n\n\t\t\tconst state: string = this._validateState(urlParams);\n\n\t\t\tlogger.debug(\n\t\t\t\t`Starting ${this._config.responseType} flow with ${currentUrl}`\n\t\t\t);\n\t\t\tif (this._config.responseType === 'code') {\n\t\t\t\treturn { ...(await this._handleCodeFlow(currentUrl)), state };\n\t\t\t} else {\n\t\t\t\treturn { ...(await this._handleImplicitFlow(currentUrl)), state };\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tlogger.debug(`Error handling auth response.`, e);\n\t\t\tthrow e;\n\t\t}\n\t}\n\n\tprivate _validateState(urlParams: any): string {\n\t\tif (!urlParams) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst savedState = oAuthStorage.getState();\n\t\tconst { state: returnedState } = urlParams;\n\n\t\t// This is because savedState only exists if the flow was initiated by Amplify\n\t\tif (savedState && savedState !== returnedState) {\n\t\t\tthrow new Error('Invalid state in OAuth flow');\n\t\t}\n\t\treturn returnedState;\n\t}\n\n\tpublic async signOut() {\n\t\tlet oAuthLogoutEndpoint = 'https://' + this._config.domain + '/logout?';\n\n\t\tconst client_id = isCognitoHostedOpts(this._config)\n\t\t\t? this._cognitoClientId\n\t\t\t: this._config.oauth.clientID;\n\n\t\tconst signout_uri = isCognitoHostedOpts(this._config)\n\t\t\t? this._config.redirectSignOut\n\t\t\t: this._config.returnTo;\n\n\t\toAuthLogoutEndpoint += Object.entries({\n\t\t\tclient_id,\n\t\t\tlogout_uri: encodeURIComponent(signout_uri),\n\t\t})\n\t\t\t.map(([k, v]) => `${k}=${v}`)\n\t\t\t.join('&');\n\n\t\tdispatchAuthEvent(\n\t\t\t'oAuthSignOut',\n\t\t\t{ oAuth: 'signOut' },\n\t\t\t`Signing out from ${oAuthLogoutEndpoint}`\n\t\t);\n\t\tlogger.debug(`Signing out from ${oAuthLogoutEndpoint}`);\n\n\t\treturn this._urlOpener(oAuthLogoutEndpoint, signout_uri);\n\t}\n\n\tprivate _generateState(length: number) {\n\t\tlet result = '';\n\t\tlet i = length;\n\t\tconst chars =\n\t\t\t'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n\t\tfor (; i > 0; --i)\n\t\t\tresult += chars[Math.round(Math.random() * (chars.length - 1))];\n\t\treturn result;\n\t}\n\n\tprivate _generateChallenge(code: string) {\n\t\tconst awsCryptoHash = new Sha256();\n\t\tawsCryptoHash.update(code);\n\n\t\tconst resultFromAWSCrypto = awsCryptoHash.digestSync();\n\t\tconst b64 = Buffer.from(resultFromAWSCrypto).toString('base64');\n\t\tconst base64URLFromAWSCrypto = this._base64URL(b64);\n\n\t\treturn base64URLFromAWSCrypto;\n\t}\n\n\tprivate _base64URL(string) {\n\t\treturn string.replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n\t}\n\n\tprivate _generateRandom(size: number) {\n\t\tconst CHARSET =\n\t\t\t'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~';\n\t\tconst buffer = new Uint8Array(size);\n\t\tif (typeof window !== 'undefined' && !!window.crypto) {\n\t\t\twindow.crypto.getRandomValues(buffer);\n\t\t} else {\n\t\t\tfor (let i = 0; i < size; i += 1) {\n\t\t\t\tbuffer[i] = (Math.random() * CHARSET.length) | 0;\n\t\t\t}\n\t\t}\n\t\treturn this._bufferToString(buffer);\n\t}\n\n\tprivate _bufferToString(buffer: Uint8Array) {\n\t\tconst CHARSET =\n\t\t\t'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\t\tconst state = [];\n\t\tfor (let i = 0; i < buffer.byteLength; i += 1) {\n\t\t\tconst index = buffer[i] % CHARSET.length;\n\t\t\tstate.push(CHARSET[index]);\n\t\t}\n\t\treturn state.join('');\n\t}\n}\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 516, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/urlListener.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/urlListener.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nimport { browserOrNode } from '@aws-amplify/core';\n\nexport default callback => {\n\tif (browserOrNode().isBrowser && window.location) {\n\t\tconst url = window.location.href;\n\n\t\tcallback({ url });\n\t} else if (browserOrNode().isNode) {\n\t\t// continue building on ssr\n\t\t() => {}; // noop\n\t} else {\n\t\tthrow new Error('Not supported');\n\t}\n};\n"],"names":[],"mappings":";;;;AAAA,qEAAqE;AACrE,sCAAsC;AACtC,OAAO,EAAE,aAAa,EAAE,MAAM,mBAAmB,CAAC;;uCAEnC,SAAA,QAAQ;IACtB,QAAI,6KAAa,EAAE,EAAC,SAAS,IAAI,MAAM,CAAC,QAAQ,EAAE;QACjD,IAAM,GAAG,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC;QAEjC,QAAQ,CAAC;YAAE,GAAG,EAAA,GAAA;QAAA,CAAE,CAAC,CAAC;KAClB,MAAM,QAAI,6KAAa,EAAE,EAAC,MAAM,EAAE;QAClC,2BAA2B;QAC3B,CAAA,YAAO,CAAC,CAAA,CAAC,CAAC,OAAO;KACjB,MAAM;QACN,MAAM,IAAI,KAAK,CAAC,eAAe,CAAC,CAAC;KACjC;AACF,CAAC,EAAC"}},
    {"offset": {"line": 542, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/common/AuthErrorStrings.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/common/AuthErrorStrings.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\nexport enum AuthErrorStrings {\n\tDEFAULT_MSG = 'Authentication Error',\n\tEMPTY_EMAIL = 'Email cannot be empty',\n\tEMPTY_PHONE = 'Phone number cannot be empty',\n\tEMPTY_USERNAME = 'Username cannot be empty',\n\tINVALID_USERNAME = 'The username should either be a string or one of the sign in types',\n\tEMPTY_PASSWORD = 'Password cannot be empty',\n\tEMPTY_CODE = 'Confirmation code cannot be empty',\n\tSIGN_UP_ERROR = 'Error creating account',\n\tNO_MFA = 'No valid MFA method provided',\n\tINVALID_MFA = 'Invalid MFA type',\n\tEMPTY_CHALLENGE = 'Challenge response cannot be empty',\n\tNO_USER_SESSION = 'Failed to get the session because the user is empty',\n\tNETWORK_ERROR = 'Network Error',\n\tDEVICE_CONFIG = 'Device tracking has not been configured in this User Pool',\n\tAUTOSIGNIN_ERROR = 'Please use your credentials to sign in',\n}\n"],"names":[],"mappings":"AAAA,qEAAqE;AACrE,sCAAsC;;;;;AACtC,IAAY,gBAgBX;AAhBD,CAAA,SAAY,gBAAgB;IAC3B,gBAAA,CAAA,cAAA,GAAA,sBAAoC,CAAA;IACpC,gBAAA,CAAA,cAAA,GAAA,uBAAqC,CAAA;IACrC,gBAAA,CAAA,cAAA,GAAA,8BAA4C,CAAA;IAC5C,gBAAA,CAAA,iBAAA,GAAA,0BAA2C,CAAA;IAC3C,gBAAA,CAAA,mBAAA,GAAA,oEAAuF,CAAA;IACvF,gBAAA,CAAA,iBAAA,GAAA,0BAA2C,CAAA;IAC3C,gBAAA,CAAA,aAAA,GAAA,mCAAgD,CAAA;IAChD,gBAAA,CAAA,gBAAA,GAAA,wBAAwC,CAAA;IACxC,gBAAA,CAAA,SAAA,GAAA,8BAAuC,CAAA;IACvC,gBAAA,CAAA,cAAA,GAAA,kBAAgC,CAAA;IAChC,gBAAA,CAAA,kBAAA,GAAA,oCAAsD,CAAA;IACtD,gBAAA,CAAA,kBAAA,GAAA,qDAAuE,CAAA;IACvE,gBAAA,CAAA,gBAAA,GAAA,eAA+B,CAAA;IAC/B,gBAAA,CAAA,gBAAA,GAAA,2DAA2E,CAAA;IAC3E,gBAAA,CAAA,mBAAA,GAAA,wCAA2D,CAAA;AAC5D,CAAC,EAhBW,gBAAgB,IAAA,CAAhB,gBAAgB,GAAA,CAAA,CAAA,GAgB3B"}},
    {"offset": {"line": 570, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/Errors.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/Errors.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport { AuthErrorMessages, AuthErrorTypes } from './types';\nimport { ConsoleLogger as Logger } from '@aws-amplify/core';\nimport { AuthErrorStrings } from './common/AuthErrorStrings';\n\nconst logger = new Logger('AuthError');\n\nexport class AuthError extends Error {\n\tpublic log: string;\n\tconstructor(type: AuthErrorTypes) {\n\t\tconst { message, log } = authErrorMessages[type];\n\t\tsuper(message);\n\n\t\t// Hack for making the custom error class work when transpiled to es5\n\t\t// TODO: Delete the following 2 lines after we change the build target to >= es2015\n\t\tthis.constructor = AuthError;\n\t\tObject.setPrototypeOf(this, AuthError.prototype);\n\n\t\tthis.name = 'AuthError';\n\t\tthis.log = log || message;\n\n\t\tlogger.error(this.log);\n\t}\n}\n\nexport class NoUserPoolError extends AuthError {\n\tconstructor(type: AuthErrorTypes) {\n\t\tsuper(type);\n\n\t\t// Hack for making the custom error class work when transpiled to es5\n\t\t// TODO: Delete the following 2 lines after we change the build target to >= es2015\n\t\tthis.constructor = NoUserPoolError;\n\t\tObject.setPrototypeOf(this, NoUserPoolError.prototype);\n\n\t\tthis.name = 'NoUserPoolError';\n\t}\n}\n\nexport const authErrorMessages: AuthErrorMessages = {\n\tnoConfig: {\n\t\tmessage: AuthErrorStrings.DEFAULT_MSG,\n\t\tlog: `\n            Error: Amplify has not been configured correctly.\n            This error is typically caused by one of the following scenarios:\n\n            1. Make sure you're passing the awsconfig object to Amplify.configure() in your app's entry point\n                See https://aws-amplify.github.io/docs/js/authentication#configure-your-app for more information\n            \n            2. There might be multiple conflicting versions of amplify packages in your node_modules.\n\t\t\t\tRefer to our docs site for help upgrading Amplify packages (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js)\n        `,\n\t},\n\tmissingAuthConfig: {\n\t\tmessage: AuthErrorStrings.DEFAULT_MSG,\n\t\tlog: `\n            Error: Amplify has not been configured correctly. \n            The configuration object is missing required auth properties.\n            This error is typically caused by one of the following scenarios:\n\n            1. Did you run \\`amplify push\\` after adding auth via \\`amplify add auth\\`?\n                See https://aws-amplify.github.io/docs/js/authentication#amplify-project-setup for more information\n\n            2. This could also be caused by multiple conflicting versions of amplify packages, see (https://docs.amplify.aws/lib/troubleshooting/upgrading/q/platform/js) for help upgrading Amplify packages.\n        `,\n\t},\n\temptyUsername: {\n\t\tmessage: AuthErrorStrings.EMPTY_USERNAME,\n\t},\n\t// TODO: should include a list of valid sign-in types\n\tinvalidUsername: {\n\t\tmessage: AuthErrorStrings.INVALID_USERNAME,\n\t},\n\temptyPassword: {\n\t\tmessage: AuthErrorStrings.EMPTY_PASSWORD,\n\t},\n\temptyCode: {\n\t\tmessage: AuthErrorStrings.EMPTY_CODE,\n\t},\n\tsignUpError: {\n\t\tmessage: AuthErrorStrings.SIGN_UP_ERROR,\n\t\tlog: 'The first parameter should either be non-null string or object',\n\t},\n\tnoMFA: {\n\t\tmessage: AuthErrorStrings.NO_MFA,\n\t},\n\tinvalidMFA: {\n\t\tmessage: AuthErrorStrings.INVALID_MFA,\n\t},\n\temptyChallengeResponse: {\n\t\tmessage: AuthErrorStrings.EMPTY_CHALLENGE,\n\t},\n\tnoUserSession: {\n\t\tmessage: AuthErrorStrings.NO_USER_SESSION,\n\t},\n\tdeviceConfig: {\n\t\tmessage: AuthErrorStrings.DEVICE_CONFIG,\n\t},\n\tnetworkError: {\n\t\tmessage: AuthErrorStrings.NETWORK_ERROR,\n\t},\n\tautoSignInError: {\n\t\tmessage: AuthErrorStrings.AUTOSIGNIN_ERROR,\n\t},\n\tdefault: {\n\t\tmessage: AuthErrorStrings.DEFAULT_MSG,\n\t},\n};\n"],"names":[],"mappings":"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"}},
    {"offset": {"line": 674, "column": 0}, "map": {"version":3,"file":"turbopack:///[project]/node_modules/@aws-amplify/auth/lib-esm/Auth.js","sources":["file:///Users/merijnkok/Desktop/screen-time-journey-workspace/node_modules/%40aws-amplify/auth/src/Auth.ts"],"sourcesContent":["// Copyright Amazon.com, Inc. or its affiliates. All Rights Reserved.\n// SPDX-License-Identifier: Apache-2.0\n\nimport {\n\tAuthOptions,\n\tFederatedResponse,\n\tSignUpParams,\n\tFederatedUser,\n\tConfirmSignUpOptions,\n\tSignOutOpts,\n\tCurrentUserOpts,\n\tGetPreferredMFAOpts,\n\tSignInOpts,\n\tisUsernamePasswordOpts,\n\tisCognitoHostedOpts,\n\tisFederatedSignInOptions,\n\tisFederatedSignInOptionsCustom,\n\thasCustomState,\n\tFederatedSignInOptionsCustom,\n\tLegacyProvider,\n\tFederatedSignInOptions,\n\tAwsCognitoOAuthOpts,\n\tClientMetaData,\n} from './types';\n\nimport {\n\tAmplify,\n\tConsoleLogger as Logger,\n\tCredentials,\n\tHub,\n\tStorageHelper,\n\tICredentials,\n\tPlatform,\n\tbrowserOrNode,\n\tparseAWSExports,\n\tUniversalStorage,\n\turlSafeDecode,\n\tHubCallback,\n} from '@aws-amplify/core';\nimport {\n\tCookieStorage,\n\tCognitoUserPool,\n\tAuthenticationDetails,\n\tICognitoUserPoolData,\n\tICognitoUserData,\n\tISignUpResult,\n\tCognitoUser,\n\tMFAOption,\n\tCognitoUserSession,\n\tIAuthenticationCallback,\n\tICognitoUserAttributeData,\n\tCognitoUserAttribute,\n\tCognitoIdToken,\n\tCognitoRefreshToken,\n\tCognitoAccessToken,\n\tNodeCallback,\n\tCodeDeliveryDetails,\n} from 'amazon-cognito-identity-js';\nimport {\n\taddAuthCategoryToCognitoUserAgent,\n\taddFrameworkToCognitoUserAgent,\n} from 'amazon-cognito-identity-js/internals';\n\nimport { parse } from 'url';\nimport OAuth from './OAuth/OAuth';\nimport { default as urlListener } from './urlListener';\nimport { AuthError, NoUserPoolError } from './Errors';\nimport {\n\tAuthErrorTypes,\n\tAutoSignInOptions,\n\tCognitoHostedUIIdentityProvider,\n\tIAuthDevice,\n} from './types/Auth';\n\nconst logger = new Logger('AuthClass');\nconst USER_ADMIN_SCOPE = 'aws.cognito.signin.user.admin';\n\n// 10 sec, following this guide https://www.nngroup.com/articles/response-times-3-important-limits/\nconst OAUTH_FLOW_MS_TIMEOUT = 10 * 1000;\n\nconst AMPLIFY_SYMBOL = (\n\ttypeof Symbol !== 'undefined' && typeof Symbol.for === 'function'\n\t\t? Symbol.for('amplify_default')\n\t\t: '@@amplify_default'\n) as Symbol;\n\nconst dispatchAuthEvent = (event: string, data: any, message: string) => {\n\tHub.dispatch('auth', { event, data, message }, 'Auth', AMPLIFY_SYMBOL);\n};\n\n// Cognito Documentation for max device\n// tslint:disable-next-line:max-line-length\n// https://docs.aws.amazon.com/cognito-user-identity-pools/latest/APIReference/API_ListDevices.html#API_ListDevices_RequestSyntax\nconst MAX_DEVICES = 60;\n\nconst MAX_AUTOSIGNIN_POLLING_MS = 3 * 60 * 1000;\n\n/**\n * Provide authentication steps\n */\nexport class AuthClass {\n\tprivate _config: AuthOptions;\n\tprivate userPool: CognitoUserPool = null;\n\tprivate user: any = null;\n\tprivate _oAuthHandler: OAuth;\n\tprivate _storage;\n\tprivate _storageSync;\n\tprivate oAuthFlowInProgress: boolean = false;\n\tprivate pendingSignIn: ReturnType<AuthClass['signInWithPassword']> | null;\n\tprivate autoSignInInitiated: boolean = false;\n\tprivate inflightSessionPromise: Promise<CognitoUserSession> | null = null;\n\tprivate inflightSessionPromiseCounter: number = 0;\n\tCredentials = Credentials;\n\n\t/**\n\t * Initialize Auth with AWS configurations\n\t * @param {Object} config - Configuration of the Auth\n\t */\n\tconstructor(config: AuthOptions) {\n\t\tthis.configure(config);\n\t\tthis.currentCredentials = this.currentCredentials.bind(this);\n\t\tthis.currentUserCredentials = this.currentUserCredentials.bind(this);\n\n\t\tHub.listen('auth', ({ payload }) => {\n\t\t\tconst { event } = payload;\n\t\t\tswitch (event) {\n\t\t\t\tcase 'verify':\n\t\t\t\tcase 'signIn':\n\t\t\t\t\tthis._storage.setItem('amplify-signin-with-hostedUI', 'false');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'signOut':\n\t\t\t\t\tthis._storage.removeItem('amplify-signin-with-hostedUI');\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'cognitoHostedUI':\n\t\t\t\t\tthis._storage.setItem('amplify-signin-with-hostedUI', 'true');\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t});\n\n\t\taddAuthCategoryToCognitoUserAgent();\n\t\taddFrameworkToCognitoUserAgent(Platform.framework);\n\t\tPlatform.observeFrameworkChanges(() => {\n\t\t\taddFrameworkToCognitoUserAgent(Platform.framework);\n\t\t});\n\t}\n\n\tpublic getModuleName() {\n\t\treturn 'Auth';\n\t}\n\n\tconfigure(config?) {\n\t\tif (!config) return this._config || {};\n\t\tlogger.debug('configure Auth');\n\t\tconst conf = Object.assign(\n\t\t\t{},\n\t\t\tthis._config,\n\t\t\tparseAWSExports(config).Auth,\n\t\t\tconfig\n\t\t);\n\t\tthis._config = conf;\n\t\tconst {\n\t\t\tuserPoolId,\n\t\t\tuserPoolWebClientId,\n\t\t\tcookieStorage,\n\t\t\toauth,\n\t\t\tregion,\n\t\t\tidentityPoolId,\n\t\t\tmandatorySignIn,\n\t\t\trefreshHandlers,\n\t\t\tidentityPoolRegion,\n\t\t\tclientMetadata,\n\t\t\tendpoint,\n\t\t\tstorage,\n\t\t} = this._config;\n\n\t\tif (!storage) {\n\t\t\t// backward compatability\n\t\t\tif (cookieStorage) this._storage = new CookieStorage(cookieStorage);\n\t\t\telse {\n\t\t\t\tthis._storage = config.ssr\n\t\t\t\t\t? new UniversalStorage()\n\t\t\t\t\t: new StorageHelper().getStorage();\n\t\t\t}\n\t\t} else {\n\t\t\tif (!this._isValidAuthStorage(storage)) {\n\t\t\t\tlogger.error('The storage in the Auth config is not valid!');\n\t\t\t\tthrow new Error('Empty storage object');\n\t\t\t}\n\t\t\tthis._storage = storage;\n\t\t}\n\n\t\tthis._storageSync = Promise.resolve();\n\t\tif (typeof this._storage['sync'] === 'function') {\n\t\t\tthis._storageSync = this._storage['sync']();\n\t\t}\n\n\t\tif (userPoolId) {\n\t\t\tconst userPoolData: ICognitoUserPoolData = {\n\t\t\t\tUserPoolId: userPoolId,\n\t\t\t\tClientId: userPoolWebClientId,\n\t\t\t\tendpoint,\n\t\t\t};\n\t\t\tuserPoolData.Storage = this._storage;\n\n\t\t\tthis.userPool = new CognitoUserPool(\n\t\t\t\tuserPoolData,\n\t\t\t\tthis.wrapRefreshSessionCallback\n\t\t\t);\n\t\t}\n\n\t\tthis.Credentials.configure({\n\t\t\tmandatorySignIn,\n\t\t\tregion,\n\t\t\tuserPoolId,\n\t\t\tidentityPoolId,\n\t\t\trefreshHandlers,\n\t\t\tstorage: this._storage,\n\t\t\tidentityPoolRegion,\n\t\t});\n\n\t\t// initialize cognitoauth client if hosted ui options provided\n\t\t// to keep backward compatibility:\n\t\tconst cognitoHostedUIConfig = oauth\n\t\t\t? isCognitoHostedOpts(this._config.oauth)\n\t\t\t\t? oauth\n\t\t\t\t: (<any>oauth).awsCognito\n\t\t\t: undefined;\n\n\t\tif (cognitoHostedUIConfig) {\n\t\t\tconst cognitoAuthParams = Object.assign(\n\t\t\t\t{\n\t\t\t\t\tcognitoClientId: userPoolWebClientId,\n\t\t\t\t\tUserPoolId: userPoolId,\n\t\t\t\t\tdomain: cognitoHostedUIConfig['domain'],\n\t\t\t\t\tscopes: cognitoHostedUIConfig['scope'],\n\t\t\t\t\tredirectSignIn: cognitoHostedUIConfig['redirectSignIn'],\n\t\t\t\t\tredirectSignOut: cognitoHostedUIConfig['redirectSignOut'],\n\t\t\t\t\tresponseType: cognitoHostedUIConfig['responseType'],\n\t\t\t\t\tStorage: this._storage,\n\t\t\t\t\turlOpener: cognitoHostedUIConfig['urlOpener'],\n\t\t\t\t\tclientMetadata,\n\t\t\t\t},\n\t\t\t\tcognitoHostedUIConfig['options']\n\t\t\t);\n\n\t\t\tthis._oAuthHandler = new OAuth({\n\t\t\t\tscopes: cognitoAuthParams.scopes,\n\t\t\t\tconfig: cognitoAuthParams,\n\t\t\t\tcognitoClientId: cognitoAuthParams.cognitoClientId,\n\t\t\t});\n\n\t\t\t// **NOTE** - Remove this in a future major release as it is a breaking change\n\t\t\t// Prevents _handleAuthResponse from being called multiple times in Expo\n\t\t\t// See https://github.com/aws-amplify/amplify-js/issues/4388\n\t\t\tconst usedResponseUrls = {};\n\t\t\turlListener(({ url }) => {\n\t\t\t\tif (usedResponseUrls[url]) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tusedResponseUrls[url] = true;\n\t\t\t\tthis._handleAuthResponse(url);\n\t\t\t});\n\t\t}\n\n\t\tdispatchAuthEvent(\n\t\t\t'configured',\n\t\t\tnull,\n\t\t\t`The Auth category has been configured successfully`\n\t\t);\n\n\t\tif (\n\t\t\t!this.autoSignInInitiated &&\n\t\t\ttypeof this._storage['getItem'] === 'function'\n\t\t) {\n\t\t\tconst pollingInitiated = this.isTrueStorageValue(\n\t\t\t\t'amplify-polling-started'\n\t\t\t);\n\t\t\tif (pollingInitiated) {\n\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t'autoSignIn_failure',\n\t\t\t\t\tnull,\n\t\t\t\t\tAuthErrorTypes.AutoSignInError\n\t\t\t\t);\n\t\t\t\tthis._storage.removeItem('amplify-auto-sign-in');\n\t\t\t}\n\t\t\tthis._storage.removeItem('amplify-polling-started');\n\t\t}\n\t\treturn this._config;\n\t}\n\n\twrapRefreshSessionCallback = (callback: NodeCallback.Any) => {\n\t\tconst wrapped: NodeCallback.Any = (error, data) => {\n\t\t\tif (data) {\n\t\t\t\tdispatchAuthEvent('tokenRefresh', undefined, `New token retrieved`);\n\t\t\t} else {\n\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t'tokenRefresh_failure',\n\t\t\t\t\terror,\n\t\t\t\t\t`Failed to retrieve new token`\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn callback(error, data);\n\t\t};\n\t\treturn wrapped;\n\t} // prettier-ignore\n\n\t/**\n\t * Sign up with username, password and other attributes like phone, email\n\t * @param {String | object} params - The user attributes used for signin\n\t * @param {String[]} restOfAttrs - for the backward compatability\n\t * @return - A promise resolves callback data if success\n\t */\n\tpublic signUp(\n\t\tparams: string | SignUpParams,\n\t\t...restOfAttrs: string[]\n\t): Promise<ISignUpResult> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\n\t\tlet username: string = null;\n\t\tlet password: string = null;\n\t\tconst attributes: CognitoUserAttribute[] = [];\n\t\tlet validationData: CognitoUserAttribute[] = null;\n\t\tlet clientMetadata;\n\t\tlet autoSignIn: AutoSignInOptions = { enabled: false };\n\t\tlet autoSignInValidationData = {};\n\t\tlet autoSignInClientMetaData: ClientMetaData = {};\n\n\t\tif (params && typeof params === 'string') {\n\t\t\tusername = params;\n\t\t\tpassword = restOfAttrs ? restOfAttrs[0] : null;\n\t\t\tconst email: string = restOfAttrs ? restOfAttrs[1] : null;\n\t\t\tconst phone_number: string = restOfAttrs ? restOfAttrs[2] : null;\n\n\t\t\tif (email)\n\t\t\t\tattributes.push(\n\t\t\t\t\tnew CognitoUserAttribute({ Name: 'email', Value: email })\n\t\t\t\t);\n\n\t\t\tif (phone_number)\n\t\t\t\tattributes.push(\n\t\t\t\t\tnew CognitoUserAttribute({\n\t\t\t\t\t\tName: 'phone_number',\n\t\t\t\t\t\tValue: phone_number,\n\t\t\t\t\t})\n\t\t\t\t);\n\t\t} else if (params && typeof params === 'object') {\n\t\t\tusername = params['username'];\n\t\t\tpassword = params['password'];\n\n\t\t\tif (params && params.clientMetadata) {\n\t\t\t\tclientMetadata = params.clientMetadata;\n\t\t\t} else if (this._config.clientMetadata) {\n\t\t\t\tclientMetadata = this._config.clientMetadata;\n\t\t\t}\n\n\t\t\tconst attrs = params['attributes'];\n\t\t\tif (attrs) {\n\t\t\t\tObject.keys(attrs).map(key => {\n\t\t\t\t\tattributes.push(\n\t\t\t\t\t\tnew CognitoUserAttribute({ Name: key, Value: attrs[key] })\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tconst validationDataObject = params['validationData'];\n\t\t\tif (validationDataObject) {\n\t\t\t\tvalidationData = [];\n\t\t\t\tObject.keys(validationDataObject).map(key => {\n\t\t\t\t\tvalidationData.push(\n\t\t\t\t\t\tnew CognitoUserAttribute({\n\t\t\t\t\t\t\tName: key,\n\t\t\t\t\t\t\tValue: validationDataObject[key],\n\t\t\t\t\t\t})\n\t\t\t\t\t);\n\t\t\t\t});\n\t\t\t}\n\n\t\t\tautoSignIn = params.autoSignIn ?? { enabled: false };\n\t\t\tif (autoSignIn.enabled) {\n\t\t\t\tthis._storage.setItem('amplify-auto-sign-in', 'true');\n\t\t\t\tautoSignInValidationData = autoSignIn.validationData ?? {};\n\t\t\t\tautoSignInClientMetaData = autoSignIn.clientMetaData ?? {};\n\t\t\t}\n\t\t} else {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.SignUpError);\n\t\t}\n\n\t\tif (!username) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n\t\t}\n\t\tif (!password) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyPassword);\n\t\t}\n\n\t\tlogger.debug('signUp attrs:', attributes);\n\t\tlogger.debug('signUp validation data:', validationData);\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.userPool.signUp(\n\t\t\t\tusername,\n\t\t\t\tpassword,\n\t\t\t\tattributes,\n\t\t\t\tvalidationData,\n\t\t\t\t(err, data) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'signUp_failure',\n\t\t\t\t\t\t\terr,\n\t\t\t\t\t\t\t`${username} failed to signup`\n\t\t\t\t\t\t);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'signUp',\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\t`${username} has signed up successfully`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (autoSignIn.enabled) {\n\t\t\t\t\t\t\tthis.handleAutoSignIn(\n\t\t\t\t\t\t\t\tusername,\n\t\t\t\t\t\t\t\tpassword,\n\t\t\t\t\t\t\t\tautoSignInValidationData,\n\t\t\t\t\t\t\t\tautoSignInClientMetaData,\n\t\t\t\t\t\t\t\tdata\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\tprivate handleAutoSignIn(\n\t\tusername: string,\n\t\tpassword: string,\n\t\tvalidationData: {},\n\t\tclientMetadata: any,\n\t\tdata: any\n\t) {\n\t\tthis.autoSignInInitiated = true;\n\t\tconst authDetails = new AuthenticationDetails({\n\t\t\tUsername: username,\n\t\t\tPassword: password,\n\t\t\tValidationData: validationData,\n\t\t\tClientMetadata: clientMetadata,\n\t\t});\n\t\tif (data.userConfirmed) {\n\t\t\tthis.signInAfterUserConfirmed(authDetails);\n\t\t} else if (this._config.signUpVerificationMethod === 'link') {\n\t\t\tthis.handleLinkAutoSignIn(authDetails);\n\t\t} else {\n\t\t\tthis.handleCodeAutoSignIn(authDetails);\n\t\t}\n\t}\n\n\tprivate handleCodeAutoSignIn(authDetails: AuthenticationDetails) {\n\t\tconst listenEvent = ({ payload }) => {\n\t\t\tif (payload.event === 'confirmSignUp') {\n\t\t\t\tthis.signInAfterUserConfirmed(authDetails, listenEvent);\n\t\t\t}\n\t\t};\n\t\tHub.listen('auth', listenEvent);\n\t}\n\n\tprivate handleLinkAutoSignIn(authDetails: AuthenticationDetails) {\n\t\tthis._storage.setItem('amplify-polling-started', 'true');\n\t\tconst start = Date.now();\n\t\tconst autoSignInPollingIntervalId = setInterval(() => {\n\t\t\tif (Date.now() - start > MAX_AUTOSIGNIN_POLLING_MS) {\n\t\t\t\tclearInterval(autoSignInPollingIntervalId);\n\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t'autoSignIn_failure',\n\t\t\t\t\tnull,\n\t\t\t\t\t'Please confirm your account and use your credentials to sign in.'\n\t\t\t\t);\n\t\t\t\tthis._storage.removeItem('amplify-auto-sign-in');\n\t\t\t} else {\n\t\t\t\tthis.signInAfterUserConfirmed(\n\t\t\t\t\tauthDetails,\n\t\t\t\t\tnull,\n\t\t\t\t\tautoSignInPollingIntervalId\n\t\t\t\t);\n\t\t\t}\n\t\t}, 5000);\n\t}\n\n\tprivate async signInAfterUserConfirmed(\n\t\tauthDetails: AuthenticationDetails,\n\t\tlistenEvent?: HubCallback,\n\t\tautoSignInPollingIntervalId?: ReturnType<typeof setInterval>\n\t) {\n\t\tconst user = this.createCognitoUser(authDetails.getUsername());\n\t\ttry {\n\t\t\tawait user.authenticateUser(\n\t\t\t\tauthDetails,\n\t\t\t\tthis.authCallbacks(\n\t\t\t\t\tuser,\n\t\t\t\t\tvalue => {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'autoSignIn',\n\t\t\t\t\t\t\tvalue,\n\t\t\t\t\t\t\t`${authDetails.getUsername()} has signed in successfully`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (listenEvent) {\n\t\t\t\t\t\t\tHub.remove('auth', listenEvent);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (autoSignInPollingIntervalId) {\n\t\t\t\t\t\t\tclearInterval(autoSignInPollingIntervalId);\n\t\t\t\t\t\t\tthis._storage.removeItem('amplify-polling-started');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis._storage.removeItem('amplify-auto-sign-in');\n\t\t\t\t\t},\n\t\t\t\t\terror => {\n\t\t\t\t\t\tlogger.error(error);\n\t\t\t\t\t\tthis._storage.removeItem('amplify-auto-sign-in');\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t} catch (error) {\n\t\t\tlogger.error(error);\n\t\t}\n\t}\n\n\t/**\n\t * Send the verification code to confirm sign up\n\t * @param {String} username - The username to be confirmed\n\t * @param {String} code - The verification code\n\t * @param {ConfirmSignUpOptions} options - other options for confirm signup\n\t * @return - A promise resolves callback data if success\n\t */\n\tpublic confirmSignUp(\n\t\tusername: string,\n\t\tcode: string,\n\t\toptions?: ConfirmSignUpOptions\n\t): Promise<any> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\t\tif (!username) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n\t\t}\n\t\tif (!code) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyCode);\n\t\t}\n\n\t\tconst user = this.createCognitoUser(username);\n\t\tconst forceAliasCreation =\n\t\t\toptions && typeof options.forceAliasCreation === 'boolean'\n\t\t\t\t? options.forceAliasCreation\n\t\t\t\t: true;\n\n\t\tlet clientMetadata;\n\t\tif (options && options.clientMetadata) {\n\t\t\tclientMetadata = options.clientMetadata;\n\t\t} else if (this._config.clientMetadata) {\n\t\t\tclientMetadata = this._config.clientMetadata;\n\t\t}\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.confirmRegistration(\n\t\t\t\tcode,\n\t\t\t\tforceAliasCreation,\n\t\t\t\t(err, data) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'confirmSignUp',\n\t\t\t\t\t\t\tdata,\n\t\t\t\t\t\t\t`${username} has been confirmed successfully`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tconst autoSignIn = this.isTrueStorageValue('amplify-auto-sign-in');\n\t\t\t\t\t\tif (autoSignIn && !this.autoSignInInitiated) {\n\t\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t\t'autoSignIn_failure',\n\t\t\t\t\t\t\t\tnull,\n\t\t\t\t\t\t\t\tAuthErrorTypes.AutoSignInError\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tthis._storage.removeItem('amplify-auto-sign-in');\n\t\t\t\t\t\t}\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\tprivate isTrueStorageValue(value: string) {\n\t\tconst item = this._storage.getItem(value);\n\t\treturn item ? item === 'true' : false;\n\t}\n\n\t/**\n\t * Resend the verification code\n\t * @param {String} username - The username to be confirmed\n\t * @param {ClientMetadata} clientMetadata - Metadata to be passed to Cognito Lambda triggers\n\t * @return - A promise resolves code delivery details if successful\n\t */\n\tpublic resendSignUp(\n\t\tusername: string,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<any> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\t\tif (!username) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n\t\t}\n\n\t\tconst user = this.createCognitoUser(username);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.resendConfirmationCode((err, data) => {\n\t\t\t\tif (err) {\n\t\t\t\t\treject(err);\n\t\t\t\t} else {\n\t\t\t\t\tresolve(data);\n\t\t\t\t}\n\t\t\t}, clientMetadata);\n\t\t});\n\t}\n\n\t/**\n\t * Sign in\n\t * @param {String | SignInOpts} usernameOrSignInOpts - The username to be signed in or the sign in options\n\t * @param {String} pw - The password of the username\n\t * @param {ClientMetaData} clientMetadata - Client metadata for custom workflows\n\t * @return - A promise resolves the CognitoUser\n\t */\n\tpublic signIn(\n\t\tusernameOrSignInOpts: string | SignInOpts,\n\t\tpw?: string,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<CognitoUser | any> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\n\t\tlet username = null;\n\t\tlet password = null;\n\t\tlet validationData = {};\n\n\t\t// for backward compatibility\n\t\tif (typeof usernameOrSignInOpts === 'string') {\n\t\t\tusername = usernameOrSignInOpts;\n\t\t\tpassword = pw;\n\t\t} else if (isUsernamePasswordOpts(usernameOrSignInOpts)) {\n\t\t\tif (typeof pw !== 'undefined') {\n\t\t\t\tlogger.warn(\n\t\t\t\t\t'The password should be defined under the first parameter object!'\n\t\t\t\t);\n\t\t\t}\n\t\t\tusername = usernameOrSignInOpts.username;\n\t\t\tpassword = usernameOrSignInOpts.password;\n\t\t\tvalidationData = usernameOrSignInOpts.validationData;\n\t\t} else {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.InvalidUsername);\n\t\t}\n\t\tif (!username) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n\t\t}\n\t\tconst authDetails = new AuthenticationDetails({\n\t\t\tUsername: username,\n\t\t\tPassword: password,\n\t\t\tValidationData: validationData,\n\t\t\tClientMetadata: clientMetadata,\n\t\t});\n\t\tif (password) {\n\t\t\treturn this.signInWithPassword(authDetails);\n\t\t} else {\n\t\t\treturn this.signInWithoutPassword(authDetails);\n\t\t}\n\t}\n\n\t/**\n\t * Return an object with the authentication callbacks\n\t * @param {CognitoUser} user - the cognito user object\n\t * @param {} resolve - function called when resolving the current step\n\t * @param {} reject - function called when rejecting the current step\n\t * @return - an object with the callback methods for user authentication\n\t */\n\tprivate authCallbacks(\n\t\tuser: CognitoUser,\n\t\tresolve: (value?: CognitoUser | any) => void,\n\t\treject: (value?: any) => void\n\t): IAuthenticationCallback {\n\t\tconst that = this;\n\t\treturn {\n\t\t\tonSuccess: async session => {\n\t\t\t\tlogger.debug(session);\n\t\t\t\tdelete user['challengeName'];\n\t\t\t\tdelete user['challengeParam'];\n\t\t\t\ttry {\n\t\t\t\t\tawait this.Credentials.clear();\n\t\t\t\t\tconst cred = await this.Credentials.set(session, 'session');\n\t\t\t\t\tlogger.debug('succeed to get cognito credentials', cred);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlogger.debug('cannot get cognito credentials', e);\n\t\t\t\t} finally {\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// In order to get user attributes and MFA methods\n\t\t\t\t\t\t// We need to trigger currentUserPoolUser again\n\t\t\t\t\t\tconst currentUser = await this.currentUserPoolUser();\n\t\t\t\t\t\tthat.user = currentUser;\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'signIn',\n\t\t\t\t\t\t\tcurrentUser,\n\t\t\t\t\t\t\t`A user ${user.getUsername()} has been signed in`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tresolve(currentUser);\n\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\tlogger.error('Failed to get the signed in user', e);\n\t\t\t\t\t\treject(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tonFailure: err => {\n\t\t\t\tlogger.debug('signIn failure', err);\n\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t'signIn_failure',\n\t\t\t\t\terr,\n\t\t\t\t\t`${user.getUsername()} failed to signin`\n\t\t\t\t);\n\t\t\t\treject(err);\n\t\t\t},\n\t\t\tcustomChallenge: challengeParam => {\n\t\t\t\tlogger.debug('signIn custom challenge answer required');\n\t\t\t\tuser['challengeName'] = 'CUSTOM_CHALLENGE';\n\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\tresolve(user);\n\t\t\t},\n\t\t\tmfaRequired: (challengeName, challengeParam) => {\n\t\t\t\tlogger.debug('signIn MFA required');\n\t\t\t\tuser['challengeName'] = challengeName;\n\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\tresolve(user);\n\t\t\t},\n\t\t\tmfaSetup: (challengeName, challengeParam) => {\n\t\t\t\tlogger.debug('signIn mfa setup', challengeName);\n\t\t\t\tuser['challengeName'] = challengeName;\n\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\tresolve(user);\n\t\t\t},\n\t\t\tnewPasswordRequired: (userAttributes, requiredAttributes) => {\n\t\t\t\tlogger.debug('signIn new password');\n\t\t\t\tuser['challengeName'] = 'NEW_PASSWORD_REQUIRED';\n\t\t\t\tuser['challengeParam'] = {\n\t\t\t\t\tuserAttributes,\n\t\t\t\t\trequiredAttributes,\n\t\t\t\t};\n\t\t\t\tresolve(user);\n\t\t\t},\n\t\t\ttotpRequired: (challengeName, challengeParam) => {\n\t\t\t\tlogger.debug('signIn totpRequired');\n\t\t\t\tuser['challengeName'] = challengeName;\n\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\tresolve(user);\n\t\t\t},\n\t\t\tselectMFAType: (challengeName, challengeParam) => {\n\t\t\t\tlogger.debug('signIn selectMFAType', challengeName);\n\t\t\t\tuser['challengeName'] = challengeName;\n\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\tresolve(user);\n\t\t\t},\n\t\t};\n\t}\n\n\t/**\n\t * Sign in with a password\n\t * @private\n\t * @param {AuthenticationDetails} authDetails - the user sign in data\n\t * @return - A promise resolves the CognitoUser object if success or mfa required\n\t */\n\tprivate signInWithPassword(\n\t\tauthDetails: AuthenticationDetails\n\t): Promise<CognitoUser | any> {\n\t\tif (this.pendingSignIn) {\n\t\t\tthrow new Error('Pending sign-in attempt already in progress');\n\t\t}\n\n\t\tconst user = this.createCognitoUser(authDetails.getUsername());\n\n\t\tthis.pendingSignIn = new Promise((resolve, reject) => {\n\t\t\tuser.authenticateUser(\n\t\t\t\tauthDetails,\n\t\t\t\tthis.authCallbacks(\n\t\t\t\t\tuser,\n\t\t\t\t\tvalue => {\n\t\t\t\t\t\tthis.pendingSignIn = null;\n\t\t\t\t\t\tresolve(value);\n\t\t\t\t\t},\n\t\t\t\t\terror => {\n\t\t\t\t\t\tthis.pendingSignIn = null;\n\t\t\t\t\t\treject(error);\n\t\t\t\t\t}\n\t\t\t\t)\n\t\t\t);\n\t\t});\n\n\t\treturn this.pendingSignIn;\n\t}\n\n\t/**\n\t * Sign in without a password\n\t * @private\n\t * @param {AuthenticationDetails} authDetails - the user sign in data\n\t * @return - A promise resolves the CognitoUser object if success or mfa required\n\t */\n\tprivate signInWithoutPassword(\n\t\tauthDetails: AuthenticationDetails\n\t): Promise<CognitoUser | any> {\n\t\tconst user = this.createCognitoUser(authDetails.getUsername());\n\t\tuser.setAuthenticationFlowType('CUSTOM_AUTH');\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.initiateAuth(authDetails, this.authCallbacks(user, resolve, reject));\n\t\t});\n\t}\n\n\t/**\n\t * This was previously used by an authenticated user to get MFAOptions,\n\t * but no longer returns a meaningful response. Refer to the documentation for\n\t * how to setup and use MFA: https://docs.amplify.aws/lib/auth/mfa/q/platform/js\n\t * @deprecated\n\t * @param {CognitoUser} user - the current user\n\t * @return - A promise resolves the current preferred mfa option if success\n\t */\n\tpublic getMFAOptions(user: CognitoUser | any): Promise<MFAOption[]> {\n\t\treturn new Promise((res, rej) => {\n\t\t\tuser.getMFAOptions((err, mfaOptions) => {\n\t\t\t\tif (err) {\n\t\t\t\t\tlogger.debug('get MFA Options failed', err);\n\t\t\t\t\trej(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlogger.debug('get MFA options success', mfaOptions);\n\t\t\t\tres(mfaOptions);\n\t\t\t\treturn;\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * get preferred mfa method\n\t * @param {CognitoUser} user - the current cognito user\n\t * @param {GetPreferredMFAOpts} params - options for getting the current user preferred MFA\n\t */\n\tpublic getPreferredMFA(\n\t\tuser: CognitoUser | any,\n\t\tparams?: GetPreferredMFAOpts\n\t): Promise<string> {\n\t\tconst that = this;\n\t\treturn new Promise((res, rej) => {\n\t\t\tconst clientMetadata = this._config.clientMetadata; // TODO: verify behavior if this is override during signIn\n\n\t\t\tconst bypassCache = params ? params.bypassCache : false;\n\t\t\tuser.getUserData(\n\t\t\t\tasync (err, data) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tlogger.debug('getting preferred mfa failed', err);\n\t\t\t\t\t\tif (this.isSessionInvalid(err)) {\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tawait this.cleanUpInvalidSession(user);\n\t\t\t\t\t\t\t} catch (cleanUpError) {\n\t\t\t\t\t\t\t\trej(\n\t\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t\t`Session is invalid due to: ${err.message} and failed to clean up invalid session: ${cleanUpError.message}`\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\trej(err);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\tconst mfaType = that._getMfaTypeFromUserData(data);\n\t\t\t\t\tif (!mfaType) {\n\t\t\t\t\t\trej('invalid MFA Type');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tres(mfaType);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t{ bypassCache, clientMetadata }\n\t\t\t);\n\t\t});\n\t}\n\n\tprivate _getMfaTypeFromUserData(data) {\n\t\tlet ret = null;\n\t\tconst preferredMFA = data.PreferredMfaSetting;\n\t\t// if the user has used Auth.setPreferredMFA() to setup the mfa type\n\t\t// then the \"PreferredMfaSetting\" would exist in the response\n\t\tif (preferredMFA) {\n\t\t\tret = preferredMFA;\n\t\t} else {\n\t\t\t// if mfaList exists but empty, then its noMFA\n\t\t\tconst mfaList = data.UserMFASettingList;\n\t\t\tif (!mfaList) {\n\t\t\t\t// if SMS was enabled by using Auth.enableSMS(),\n\t\t\t\t// the response would contain MFAOptions\n\t\t\t\t// as for now Cognito only supports for SMS, so we will say it is 'SMS_MFA'\n\t\t\t\t// if it does not exist, then it should be NOMFA\n\t\t\t\tconst MFAOptions = data.MFAOptions;\n\t\t\t\tif (MFAOptions) {\n\t\t\t\t\tret = 'SMS_MFA';\n\t\t\t\t} else {\n\t\t\t\t\tret = 'NOMFA';\n\t\t\t\t}\n\t\t\t} else if (mfaList.length === 0) {\n\t\t\t\tret = 'NOMFA';\n\t\t\t} else {\n\t\t\t\tlogger.debug('invalid case for getPreferredMFA', data);\n\t\t\t}\n\t\t}\n\t\treturn ret;\n\t}\n\n\tprivate _getUserData(user, params) {\n\t\treturn new Promise((res, rej) => {\n\t\t\tuser.getUserData(async (err, data) => {\n\t\t\t\tif (err) {\n\t\t\t\t\tlogger.debug('getting user data failed', err);\n\t\t\t\t\tif (this.isSessionInvalid(err)) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.cleanUpInvalidSession(user);\n\t\t\t\t\t\t} catch (cleanUpError) {\n\t\t\t\t\t\t\trej(\n\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t`Session is invalid due to: ${err.message} and failed to clean up invalid session: ${cleanUpError.message}`\n\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\trej(err);\n\t\t\t\t\treturn;\n\t\t\t\t} else {\n\t\t\t\t\tres(data);\n\t\t\t\t}\n\t\t\t}, params);\n\t\t});\n\t}\n\n\t/**\n\t * set preferred MFA method\n\t * @param {CognitoUser} user - the current Cognito user\n\t * @param {string} mfaMethod - preferred mfa method\n\t * @return - A promise resolve if success\n\t */\n\tpublic async setPreferredMFA(\n\t\tuser: CognitoUser | any,\n\t\tmfaMethod: 'TOTP' | 'SMS' | 'NOMFA' | 'SMS_MFA' | 'SOFTWARE_TOKEN_MFA'\n\t): Promise<string> {\n\t\tconst clientMetadata = this._config.clientMetadata; // TODO: verify behavior if this is override during signIn\n\n\t\tconst userData = await this._getUserData(user, {\n\t\t\tbypassCache: true,\n\t\t\tclientMetadata,\n\t\t});\n\t\tlet smsMfaSettings = null;\n\t\tlet totpMfaSettings = null;\n\n\t\tswitch (mfaMethod) {\n\t\t\tcase 'TOTP':\n\t\t\tcase 'SOFTWARE_TOKEN_MFA':\n\t\t\t\ttotpMfaSettings = {\n\t\t\t\t\tPreferredMfa: true,\n\t\t\t\t\tEnabled: true,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'SMS':\n\t\t\tcase 'SMS_MFA':\n\t\t\t\tsmsMfaSettings = {\n\t\t\t\t\tPreferredMfa: true,\n\t\t\t\t\tEnabled: true,\n\t\t\t\t};\n\t\t\t\tbreak;\n\t\t\tcase 'NOMFA':\n\t\t\t\tconst mfaList = userData['UserMFASettingList'];\n\t\t\t\tconst currentMFAType = await this._getMfaTypeFromUserData(userData);\n\t\t\t\tif (currentMFAType === 'NOMFA') {\n\t\t\t\t\treturn Promise.resolve('No change for mfa type');\n\t\t\t\t} else if (currentMFAType === 'SMS_MFA') {\n\t\t\t\t\tsmsMfaSettings = {\n\t\t\t\t\t\tPreferredMfa: false,\n\t\t\t\t\t\tEnabled: false,\n\t\t\t\t\t};\n\t\t\t\t} else if (currentMFAType === 'SOFTWARE_TOKEN_MFA') {\n\t\t\t\t\ttotpMfaSettings = {\n\t\t\t\t\t\tPreferredMfa: false,\n\t\t\t\t\t\tEnabled: false,\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\treturn this.rejectAuthError(AuthErrorTypes.InvalidMFA);\n\t\t\t\t}\n\t\t\t\t// if there is a UserMFASettingList in the response\n\t\t\t\t// we need to disable every mfa type in that list\n\t\t\t\tif (mfaList && mfaList.length !== 0) {\n\t\t\t\t\t// to disable SMS or TOTP if exists in that list\n\t\t\t\t\tmfaList.forEach(mfaType => {\n\t\t\t\t\t\tif (mfaType === 'SMS_MFA') {\n\t\t\t\t\t\t\tsmsMfaSettings = {\n\t\t\t\t\t\t\t\tPreferredMfa: false,\n\t\t\t\t\t\t\t\tEnabled: false,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t} else if (mfaType === 'SOFTWARE_TOKEN_MFA') {\n\t\t\t\t\t\t\ttotpMfaSettings = {\n\t\t\t\t\t\t\t\tPreferredMfa: false,\n\t\t\t\t\t\t\t\tEnabled: false,\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tlogger.debug('no validmfa method provided');\n\t\t\t\treturn this.rejectAuthError(AuthErrorTypes.NoMFA);\n\t\t}\n\n\t\tconst that = this;\n\t\treturn new Promise<string>((res, rej) => {\n\t\t\tuser.setUserMfaPreference(\n\t\t\t\tsmsMfaSettings,\n\t\t\t\ttotpMfaSettings,\n\t\t\t\t(err, result) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\tlogger.debug('Set user mfa preference error', err);\n\t\t\t\t\t\treturn rej(err);\n\t\t\t\t\t}\n\t\t\t\t\tlogger.debug('Set user mfa success', result);\n\t\t\t\t\tlogger.debug('Caching the latest user data into local');\n\t\t\t\t\t// cache the latest result into user data\n\t\t\t\t\tuser.getUserData(\n\t\t\t\t\t\tasync (err, data) => {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\tlogger.debug('getting user data failed', err);\n\t\t\t\t\t\t\t\tif (this.isSessionInvalid(err)) {\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tawait this.cleanUpInvalidSession(user);\n\t\t\t\t\t\t\t\t\t} catch (cleanUpError) {\n\t\t\t\t\t\t\t\t\t\trej(\n\t\t\t\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t\t\t\t`Session is invalid due to: ${err.message} and failed to clean up invalid session: ${cleanUpError.message}`\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\treturn rej(err);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn res(result);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tbypassCache: true,\n\t\t\t\t\t\t\tclientMetadata,\n\t\t\t\t\t\t}\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * disable SMS\n\t * @deprecated\n\t * @param {CognitoUser} user - the current user\n\t * @return - A promise resolves is success\n\t */\n\tpublic disableSMS(user: CognitoUser): Promise<string> {\n\t\treturn new Promise((res, rej) => {\n\t\t\tuser.disableMFA((err, data) => {\n\t\t\t\tif (err) {\n\t\t\t\t\tlogger.debug('disable mfa failed', err);\n\t\t\t\t\trej(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlogger.debug('disable mfa succeed', data);\n\t\t\t\tres(data);\n\t\t\t\treturn;\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * enable SMS\n\t * @deprecated\n\t * @param {CognitoUser} user - the current user\n\t * @return - A promise resolves is success\n\t */\n\tpublic enableSMS(user: CognitoUser): Promise<string> {\n\t\treturn new Promise((res, rej) => {\n\t\t\tuser.enableMFA((err, data) => {\n\t\t\t\tif (err) {\n\t\t\t\t\tlogger.debug('enable mfa failed', err);\n\t\t\t\t\trej(err);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tlogger.debug('enable mfa succeed', data);\n\t\t\t\tres(data);\n\t\t\t\treturn;\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Setup TOTP\n\t * @param {CognitoUser} user - the current user\n\t * @return - A promise resolves with the secret code if success\n\t */\n\tpublic setupTOTP(user: CognitoUser | any): Promise<string> {\n\t\treturn new Promise((res, rej) => {\n\t\t\tuser.associateSoftwareToken({\n\t\t\t\tonFailure: err => {\n\t\t\t\t\tlogger.debug('associateSoftwareToken failed', err);\n\t\t\t\t\trej(err);\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t\tassociateSecretCode: secretCode => {\n\t\t\t\t\tlogger.debug('associateSoftwareToken success', secretCode);\n\t\t\t\t\tres(secretCode);\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * verify TOTP setup\n\t * @param {CognitoUser} user - the current user\n\t * @param {string} challengeAnswer - challenge answer\n\t * @return - A promise resolves is success\n\t */\n\tpublic verifyTotpToken(\n\t\tuser: CognitoUser | any,\n\t\tchallengeAnswer: string\n\t): Promise<CognitoUserSession> {\n\t\tlogger.debug('verification totp token', user, challengeAnswer);\n\n\t\tlet signInUserSession;\n\t\tif (user && typeof user.getSignInUserSession === 'function') {\n\t\t\tsignInUserSession = (user as CognitoUser).getSignInUserSession();\n\t\t}\n\t\tconst isLoggedIn = signInUserSession?.isValid();\n\n\t\treturn new Promise((res, rej) => {\n\t\t\tuser.verifySoftwareToken(challengeAnswer, 'My TOTP device', {\n\t\t\t\tonFailure: err => {\n\t\t\t\t\tlogger.debug('verifyTotpToken failed', err);\n\t\t\t\t\trej(err);\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t\tonSuccess: data => {\n\t\t\t\t\tif (!isLoggedIn) {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'signIn',\n\t\t\t\t\t\t\tuser,\n\t\t\t\t\t\t\t`A user ${user.getUsername()} has been signed in`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t'verify',\n\t\t\t\t\t\tuser,\n\t\t\t\t\t\t`A user ${user.getUsername()} has been verified`\n\t\t\t\t\t);\n\t\t\t\t\tlogger.debug('verifyTotpToken success', data);\n\t\t\t\t\tres(data);\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Send MFA code to confirm sign in\n\t * @param {Object} user - The CognitoUser object\n\t * @param {String} code - The confirmation code\n\t */\n\tpublic confirmSignIn(\n\t\tuser: CognitoUser | any,\n\t\tcode: string,\n\t\tmfaType?: 'SMS_MFA' | 'SOFTWARE_TOKEN_MFA' | null,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<CognitoUser | any> {\n\t\tif (!code) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyCode);\n\t\t}\n\n\t\tconst that = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.sendMFACode(\n\t\t\t\tcode,\n\t\t\t\t{\n\t\t\t\t\tonSuccess: async session => {\n\t\t\t\t\t\tlogger.debug(session);\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.Credentials.clear();\n\t\t\t\t\t\t\tconst cred = await this.Credentials.set(session, 'session');\n\t\t\t\t\t\t\tlogger.debug('succeed to get cognito credentials', cred);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tlogger.debug('cannot get cognito credentials', e);\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tthat.user = user;\n\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\tconst currentUser = await this.currentUserPoolUser();\n\t\t\t\t\t\t\t\tuser.attributes = currentUser.attributes;\n\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\tlogger.debug('cannot get updated Cognito User', e);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t\t'signIn',\n\t\t\t\t\t\t\t\tuser,\n\t\t\t\t\t\t\t\t`A user ${user.getUsername()} has been signed in`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tresolve(user);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonFailure: err => {\n\t\t\t\t\t\tlogger.debug('confirm signIn failure', err);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tmfaType,\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\tpublic completeNewPassword(\n\t\tuser: CognitoUser | any,\n\t\tpassword: string,\n\t\trequiredAttributes: any = {},\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<CognitoUser | any> {\n\t\tif (!password) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyPassword);\n\t\t}\n\n\t\tconst that = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.completeNewPasswordChallenge(\n\t\t\t\tpassword,\n\t\t\t\trequiredAttributes,\n\t\t\t\t{\n\t\t\t\t\tonSuccess: async session => {\n\t\t\t\t\t\tlogger.debug(session);\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tawait this.Credentials.clear();\n\t\t\t\t\t\t\tconst cred = await this.Credentials.set(session, 'session');\n\t\t\t\t\t\t\tlogger.debug('succeed to get cognito credentials', cred);\n\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\tlogger.debug('cannot get cognito credentials', e);\n\t\t\t\t\t\t} finally {\n\t\t\t\t\t\t\tthat.user = user;\n\t\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t\t'signIn',\n\t\t\t\t\t\t\t\tuser,\n\t\t\t\t\t\t\t\t`A user ${user.getUsername()} has been signed in`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tresolve(user);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonFailure: err => {\n\t\t\t\t\t\tlogger.debug('completeNewPassword failure', err);\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'completeNewPassword_failure',\n\t\t\t\t\t\t\terr,\n\t\t\t\t\t\t\t`${this.user} failed to complete the new password flow`\n\t\t\t\t\t\t);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t},\n\t\t\t\t\tmfaRequired: (challengeName, challengeParam) => {\n\t\t\t\t\t\tlogger.debug('signIn MFA required');\n\t\t\t\t\t\tuser['challengeName'] = challengeName;\n\t\t\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\t\t\tresolve(user);\n\t\t\t\t\t},\n\t\t\t\t\tmfaSetup: (challengeName, challengeParam) => {\n\t\t\t\t\t\tlogger.debug('signIn mfa setup', challengeName);\n\t\t\t\t\t\tuser['challengeName'] = challengeName;\n\t\t\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\t\t\tresolve(user);\n\t\t\t\t\t},\n\t\t\t\t\ttotpRequired: (challengeName, challengeParam) => {\n\t\t\t\t\t\tlogger.debug('signIn mfa setup', challengeName);\n\t\t\t\t\t\tuser['challengeName'] = challengeName;\n\t\t\t\t\t\tuser['challengeParam'] = challengeParam;\n\t\t\t\t\t\tresolve(user);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Send the answer to a custom challenge\n\t * @param {CognitoUser} user - The CognitoUser object\n\t * @param {String} challengeResponses - The confirmation code\n\t */\n\tpublic sendCustomChallengeAnswer(\n\t\tuser: CognitoUser | any,\n\t\tchallengeResponses: string,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<CognitoUser | any> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\t\tif (!challengeResponses) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyChallengeResponse);\n\t\t}\n\n\t\tconst that = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.sendCustomChallengeAnswer(\n\t\t\t\tchallengeResponses,\n\t\t\t\tthis.authCallbacks(user, resolve, reject),\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Delete an authenticated users' attributes\n\t * @param {CognitoUser} - The currently logged in user object\n\t * @return {Promise}\n\t **/\n\tpublic deleteUserAttributes(\n\t\tuser: CognitoUser | any,\n\t\tattributeNames: string[]\n\t) {\n\t\tconst that = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthat.userSession(user).then(session => {\n\t\t\t\tuser.deleteAttributes(attributeNames, (err, result) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn resolve(result);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Delete the current authenticated user\n\t * @return {Promise}\n\t **/\n\t// TODO: Check return type void\n\tpublic async deleteUser(): Promise<string | void> {\n\t\ttry {\n\t\t\tawait this._storageSync;\n\t\t} catch (e) {\n\t\t\tlogger.debug('Failed to sync cache info into memory', e);\n\t\t\tthrow new Error(e);\n\t\t}\n\n\t\tconst isSignedInHostedUI =\n\t\t\tthis._oAuthHandler &&\n\t\t\tthis._storage.getItem('amplify-signin-with-hostedUI') === 'true';\n\n\t\treturn new Promise(async (res, rej) => {\n\t\t\tif (this.userPool) {\n\t\t\t\tconst user = this.userPool.getCurrentUser();\n\n\t\t\t\tif (!user) {\n\t\t\t\t\tlogger.debug('Failed to get user from user pool');\n\t\t\t\t\treturn rej(new Error('No current user.'));\n\t\t\t\t} else {\n\t\t\t\t\tuser.getSession(async (err, session) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tlogger.debug('Failed to get the user session', err);\n\t\t\t\t\t\t\tif (this.isSessionInvalid(err)) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tawait this.cleanUpInvalidSession(user);\n\t\t\t\t\t\t\t\t} catch (cleanUpError) {\n\t\t\t\t\t\t\t\t\trej(\n\t\t\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t\t\t`Session is invalid due to: ${err.message} and failed to clean up invalid session: ${cleanUpError.message}`\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn rej(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tuser.deleteUser((err, result: string) => {\n\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\trej(err);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t\t\t\t'userDeleted',\n\t\t\t\t\t\t\t\t\t\tresult,\n\t\t\t\t\t\t\t\t\t\t'The authenticated user has been deleted.'\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\tuser.signOut();\n\t\t\t\t\t\t\t\t\tthis.user = null;\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tthis.cleanCachedItems(); // clean aws credentials\n\t\t\t\t\t\t\t\t\t} catch (e) {\n\t\t\t\t\t\t\t\t\t\t// TODO: change to rejects in refactor\n\t\t\t\t\t\t\t\t\t\tlogger.debug('failed to clear cached items');\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tif (isSignedInHostedUI) {\n\t\t\t\t\t\t\t\t\t\tthis.oAuthSignOutRedirect(res, rej);\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t\t\t\t\t'signOut',\n\t\t\t\t\t\t\t\t\t\t\tthis.user,\n\t\t\t\t\t\t\t\t\t\t\t`A user has been signed out`\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tres(result);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlogger.debug('no Congito User pool');\n\t\t\t\trej(new Error('Cognito User pool does not exist'));\n\t\t\t}\n\t\t});\n\t}\n\n\t/**\n\t * Update an authenticated users' attributes\n\t * @param {CognitoUser} - The currently logged in user object\n\t * @return {Promise}\n\t **/\n\tpublic updateUserAttributes(\n\t\tuser: CognitoUser | any,\n\t\tattributes: object,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<string> {\n\t\tconst attributeList: ICognitoUserAttributeData[] = [];\n\t\tconst that = this;\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthat.userSession(user).then(session => {\n\t\t\t\tfor (const key in attributes) {\n\t\t\t\t\tif (key !== 'sub' && key.indexOf('_verified') < 0) {\n\t\t\t\t\t\tconst attr: ICognitoUserAttributeData = {\n\t\t\t\t\t\t\tName: key,\n\t\t\t\t\t\t\tValue: attributes[key],\n\t\t\t\t\t\t};\n\t\t\t\t\t\tattributeList.push(attr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tuser.updateAttributes(\n\t\t\t\t\tattributeList,\n\t\t\t\t\t(err, result, details) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t\t'updateUserAttributes_failure',\n\t\t\t\t\t\t\t\terr,\n\t\t\t\t\t\t\t\t'Failed to update attributes'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst attrs = this.createUpdateAttributesResultList(\n\t\t\t\t\t\t\t\tattributes as Record<string, string>,\n\t\t\t\t\t\t\t\tdetails?.CodeDeliveryDetailsList\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t\t'updateUserAttributes',\n\t\t\t\t\t\t\t\tattrs,\n\t\t\t\t\t\t\t\t'Attributes successfully updated'\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn resolve(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tclientMetadata\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\tprivate createUpdateAttributesResultList(\n\t\tattributes: Record<string, string>,\n\t\tcodeDeliveryDetailsList?: CodeDeliveryDetails[]\n\t): Record<string, string> {\n\t\tconst attrs = {};\n\t\tObject.keys(attributes).forEach(key => {\n\t\t\tattrs[key] = {\n\t\t\t\tisUpdated: true,\n\t\t\t};\n\t\t\tconst codeDeliveryDetails = codeDeliveryDetailsList?.find(\n\t\t\t\tvalue => value.AttributeName === key\n\t\t\t);\n\t\t\tif (codeDeliveryDetails) {\n\t\t\t\tattrs[key].isUpdated = false;\n\t\t\t\tattrs[key].codeDeliveryDetails = codeDeliveryDetails;\n\t\t\t}\n\t\t});\n\t\treturn attrs;\n\t}\n\n\t/**\n\t * Return user attributes\n\t * @param {Object} user - The CognitoUser object\n\t * @return - A promise resolves to user attributes if success\n\t */\n\tpublic userAttributes(\n\t\tuser: CognitoUser | any\n\t): Promise<CognitoUserAttribute[]> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.userSession(user).then(session => {\n\t\t\t\tuser.getUserAttributes((err, attributes) => {\n\t\t\t\t\tif (err) {\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresolve(attributes);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic verifiedContact(user: CognitoUser | any) {\n\t\tconst that = this;\n\t\treturn this.userAttributes(user).then(attributes => {\n\t\t\tconst attrs = that.attributesToObject(attributes);\n\t\t\tconst unverified = {};\n\t\t\tconst verified = {};\n\t\t\tif (attrs['email']) {\n\t\t\t\tif (attrs['email_verified']) {\n\t\t\t\t\tverified['email'] = attrs['email'];\n\t\t\t\t} else {\n\t\t\t\t\tunverified['email'] = attrs['email'];\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (attrs['phone_number']) {\n\t\t\t\tif (attrs['phone_number_verified']) {\n\t\t\t\t\tverified['phone_number'] = attrs['phone_number'];\n\t\t\t\t} else {\n\t\t\t\t\tunverified['phone_number'] = attrs['phone_number'];\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tverified,\n\t\t\t\tunverified,\n\t\t\t};\n\t\t});\n\t}\n\n\tprivate isErrorWithMessage(err: any): err is { message: string } {\n\t\treturn (\n\t\t\ttypeof err === 'object' &&\n\t\t\tObject.prototype.hasOwnProperty.call(err, 'message')\n\t\t);\n\t}\n\n\t// Session revoked by another app\n\tprivate isTokenRevokedError(\n\t\terr: any\n\t): err is { message: 'Access Token has been revoked' } {\n\t\treturn (\n\t\t\tthis.isErrorWithMessage(err) &&\n\t\t\terr.message === 'Access Token has been revoked'\n\t\t);\n\t}\n\n\tprivate isRefreshTokenRevokedError(\n\t\terr: any\n\t): err is { message: 'Refresh Token has been revoked' } {\n\t\treturn (\n\t\t\tthis.isErrorWithMessage(err) &&\n\t\t\terr.message === 'Refresh Token has been revoked'\n\t\t);\n\t}\n\n\tprivate isUserDisabledError(\n\t\terr: any\n\t): err is { message: 'User is disabled.' } {\n\t\treturn this.isErrorWithMessage(err) && err.message === 'User is disabled.';\n\t}\n\n\tprivate isUserDoesNotExistError(\n\t\terr: any\n\t): err is { message: 'User does not exist.' } {\n\t\treturn (\n\t\t\tthis.isErrorWithMessage(err) && err.message === 'User does not exist.'\n\t\t);\n\t}\n\n\tprivate isRefreshTokenExpiredError(\n\t\terr: any\n\t): err is { message: 'Refresh Token has expired' } {\n\t\treturn (\n\t\t\tthis.isErrorWithMessage(err) &&\n\t\t\terr.message === 'Refresh Token has expired'\n\t\t);\n\t}\n\n\tprivate isPasswordResetRequiredError(\n\t\terr: any\n\t): err is { message: 'Password reset required for the user' } {\n\t\treturn (\n\t\t\tthis.isErrorWithMessage(err) &&\n\t\t\terr.message === 'Password reset required for the user'\n\t\t);\n\t}\n\n\tprivate isSignedInHostedUI() {\n\t\treturn (\n\t\t\tthis._oAuthHandler &&\n\t\t\tthis._storage.getItem('amplify-signin-with-hostedUI') === 'true'\n\t\t);\n\t}\n\n\tprivate isSessionInvalid(err: any) {\n\t\treturn (\n\t\t\tthis.isUserDisabledError(err) ||\n\t\t\tthis.isUserDoesNotExistError(err) ||\n\t\t\tthis.isTokenRevokedError(err) ||\n\t\t\tthis.isRefreshTokenRevokedError(err) ||\n\t\t\tthis.isRefreshTokenExpiredError(err) ||\n\t\t\tthis.isPasswordResetRequiredError(err)\n\t\t);\n\t}\n\n\tprivate async cleanUpInvalidSession(user: CognitoUser) {\n\t\tuser.signOut();\n\t\tthis.user = null;\n\t\ttry {\n\t\t\tawait this.cleanCachedItems(); // clean aws credentials\n\t\t} catch (e) {\n\t\t\tlogger.debug('failed to clear cached items');\n\t\t}\n\t\tif (this.isSignedInHostedUI()) {\n\t\t\treturn new Promise((res, rej) => {\n\t\t\t\tthis.oAuthSignOutRedirect(res, rej);\n\t\t\t});\n\t\t} else {\n\t\t\tdispatchAuthEvent('signOut', this.user, `A user has been signed out`);\n\t\t}\n\t}\n\n\t/**\n\t * Get current authenticated user\n\t * @return - A promise resolves to current authenticated CognitoUser if success\n\t */\n\tpublic currentUserPoolUser(\n\t\tparams?: CurrentUserOpts\n\t): Promise<CognitoUser | any> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\n\t\treturn new Promise((res, rej) => {\n\t\t\tthis._storageSync\n\t\t\t\t.then(async () => {\n\t\t\t\t\tif (this.isOAuthInProgress()) {\n\t\t\t\t\t\tlogger.debug('OAuth signIn in progress, waiting for resolution...');\n\n\t\t\t\t\t\tawait new Promise(res => {\n\t\t\t\t\t\t\tconst timeoutId = setTimeout(() => {\n\t\t\t\t\t\t\t\tlogger.debug('OAuth signIn in progress timeout');\n\n\t\t\t\t\t\t\t\tHub.remove('auth', hostedUISignCallback);\n\n\t\t\t\t\t\t\t\tres();\n\t\t\t\t\t\t\t}, OAUTH_FLOW_MS_TIMEOUT);\n\n\t\t\t\t\t\t\tHub.listen('auth', hostedUISignCallback);\n\n\t\t\t\t\t\t\tfunction hostedUISignCallback({ payload }) {\n\t\t\t\t\t\t\t\tconst { event } = payload;\n\n\t\t\t\t\t\t\t\tif (\n\t\t\t\t\t\t\t\t\tevent === 'cognitoHostedUI' ||\n\t\t\t\t\t\t\t\t\tevent === 'cognitoHostedUI_failure'\n\t\t\t\t\t\t\t\t) {\n\t\t\t\t\t\t\t\t\tlogger.debug(`OAuth signIn resolved: ${event}`);\n\t\t\t\t\t\t\t\t\tclearTimeout(timeoutId);\n\n\t\t\t\t\t\t\t\t\tHub.remove('auth', hostedUISignCallback);\n\n\t\t\t\t\t\t\t\t\tres();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\n\t\t\t\t\tconst user = this.userPool.getCurrentUser();\n\n\t\t\t\t\tif (!user) {\n\t\t\t\t\t\tlogger.debug('Failed to get user from user pool');\n\t\t\t\t\t\trej('No current user');\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\n\t\t\t\t\t// refresh the session if the session expired.\n\t\t\t\t\ttry {\n\t\t\t\t\t\tconst session = await this._userSession(user);\n\n\t\t\t\t\t\t// get user data from Cognito\n\t\t\t\t\t\tconst bypassCache = params ? params.bypassCache : false;\n\n\t\t\t\t\t\tif (bypassCache) {\n\t\t\t\t\t\t\tawait this.Credentials.clear();\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tconst clientMetadata = this._config.clientMetadata;\n\n\t\t\t\t\t\t// validate the token's scope first before calling this function\n\t\t\t\t\t\tconst { scope = '' } = session.getAccessToken().decodePayload();\n\t\t\t\t\t\tif (scope.split(' ').includes(USER_ADMIN_SCOPE)) {\n\t\t\t\t\t\t\tuser.getUserData(\n\t\t\t\t\t\t\t\tasync (err, data) => {\n\t\t\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\t\t\tlogger.debug('getting user data failed', err);\n\t\t\t\t\t\t\t\t\t\tif (this.isSessionInvalid(err)) {\n\t\t\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\t\t\tawait this.cleanUpInvalidSession(user);\n\t\t\t\t\t\t\t\t\t\t\t} catch (cleanUpError) {\n\t\t\t\t\t\t\t\t\t\t\t\trej(\n\t\t\t\t\t\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t`Session is invalid due to: ${err.message} and failed to clean up invalid session: ${cleanUpError.message}`\n\t\t\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\trej(err);\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\tres(user);\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tconst preferredMFA = data.PreferredMfaSetting || 'NOMFA';\n\t\t\t\t\t\t\t\t\tconst attributeList = [];\n\n\t\t\t\t\t\t\t\t\tfor (let i = 0; i < data.UserAttributes.length; i++) {\n\t\t\t\t\t\t\t\t\t\tconst attribute = {\n\t\t\t\t\t\t\t\t\t\t\tName: data.UserAttributes[i].Name,\n\t\t\t\t\t\t\t\t\t\t\tValue: data.UserAttributes[i].Value,\n\t\t\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t\t\tconst userAttribute = new CognitoUserAttribute(attribute);\n\t\t\t\t\t\t\t\t\t\tattributeList.push(userAttribute);\n\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\tconst attributes = this.attributesToObject(attributeList);\n\t\t\t\t\t\t\t\t\tObject.assign(user, { attributes, preferredMFA });\n\t\t\t\t\t\t\t\t\treturn res(user);\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t{ bypassCache, clientMetadata }\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tlogger.debug(\n\t\t\t\t\t\t\t\t`Unable to get the user data because the ${USER_ADMIN_SCOPE} ` +\n\t\t\t\t\t\t\t\t\t`is not in the scopes of the access token`\n\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\treturn res(user);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch (err) {\n\t\t\t\t\t\trej(err);\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tlogger.debug('Failed to sync cache info into memory', e);\n\t\t\t\t\treturn rej(e);\n\t\t\t\t});\n\t\t});\n\t}\n\n\tprivate isOAuthInProgress(): boolean {\n\t\treturn this.oAuthFlowInProgress;\n\t}\n\n\t/**\n\t * Get current authenticated user\n\t * @param {CurrentUserOpts} - options for getting the current user\n\t * @return - A promise resolves to current authenticated CognitoUser if success\n\t */\n\tpublic async currentAuthenticatedUser(\n\t\tparams?: CurrentUserOpts\n\t): Promise<CognitoUser | any> {\n\t\tlogger.debug('getting current authenticated user');\n\t\tlet federatedUser = null;\n\t\ttry {\n\t\t\tawait this._storageSync;\n\t\t} catch (e) {\n\t\t\tlogger.debug('Failed to sync cache info into memory', e);\n\t\t\tthrow e;\n\t\t}\n\n\t\ttry {\n\t\t\tconst federatedInfo = JSON.parse(\n\t\t\t\tthis._storage.getItem('aws-amplify-federatedInfo')\n\t\t\t);\n\t\t\tif (federatedInfo) {\n\t\t\t\tfederatedUser = {\n\t\t\t\t\t...federatedInfo.user,\n\t\t\t\t\ttoken: federatedInfo.token,\n\t\t\t\t};\n\t\t\t}\n\t\t} catch (e) {\n\t\t\tlogger.debug('cannot load federated user from auth storage');\n\t\t}\n\n\t\tif (federatedUser) {\n\t\t\tthis.user = federatedUser;\n\t\t\tlogger.debug('get current authenticated federated user', this.user);\n\t\t\treturn this.user;\n\t\t} else {\n\t\t\tlogger.debug('get current authenticated userpool user');\n\t\t\tlet user = null;\n\t\t\ttry {\n\t\t\t\tuser = await this.currentUserPoolUser(params);\n\t\t\t} catch (e) {\n\t\t\t\tif (e === 'No userPool') {\n\t\t\t\t\tlogger.error(\n\t\t\t\t\t\t'Cannot get the current user because the user pool is missing. ' +\n\t\t\t\t\t\t\t'Please make sure the Auth module is configured with a valid Cognito User Pool ID'\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tlogger.debug('The user is not authenticated by the error', e);\n\t\t\t\treturn Promise.reject('The user is not authenticated');\n\t\t\t}\n\t\t\tthis.user = user;\n\t\t\treturn this.user;\n\t\t}\n\t}\n\n\t/**\n\t * Get current user's session\n\t * @return - A promise resolves to session object if success\n\t */\n\tpublic currentSession(): Promise<CognitoUserSession> {\n\t\tconst that = this;\n\t\tlogger.debug('Getting current session');\n\t\t// Purposely not calling the reject method here because we don't need a console error\n\t\tif (!this.userPool) {\n\t\t\treturn Promise.reject(new Error('No User Pool in the configuration.'));\n\t\t}\n\n\t\treturn new Promise((res, rej) => {\n\t\t\tthat\n\t\t\t\t.currentUserPoolUser()\n\t\t\t\t.then(user => {\n\t\t\t\t\tthat\n\t\t\t\t\t\t.userSession(user)\n\t\t\t\t\t\t.then(session => {\n\t\t\t\t\t\t\tres(session);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(e => {\n\t\t\t\t\t\t\tlogger.debug('Failed to get the current session', e);\n\t\t\t\t\t\t\trej(e);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(e => {\n\t\t\t\t\tlogger.debug('Failed to get the current user', e);\n\t\t\t\t\trej(e);\n\t\t\t\t\treturn;\n\t\t\t\t});\n\t\t});\n\t}\n\n\tprivate async _userSession(user?: CognitoUser): Promise<CognitoUserSession> {\n\t\tif (!user) {\n\t\t\tlogger.debug('the user is null');\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.NoUserSession);\n\t\t}\n\t\tconst clientMetadata = this._config.clientMetadata;\n\t\t// Debouncing the concurrent userSession calls by caching the promise.\n\t\t// This solution assumes users will always call this function with the same CognitoUser instance.\n\t\tif (this.inflightSessionPromiseCounter === 0) {\n\t\t\tthis.inflightSessionPromise = new Promise<CognitoUserSession>(\n\t\t\t\t(res, rej) => {\n\t\t\t\t\tuser.getSession(\n\t\t\t\t\t\tasync (err, session) => {\n\t\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\t\tlogger.debug('Failed to get the session from user', user);\n\t\t\t\t\t\t\t\tif (this.isSessionInvalid(err)) {\n\t\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\t\tawait this.cleanUpInvalidSession(user);\n\t\t\t\t\t\t\t\t\t} catch (cleanUpError) {\n\t\t\t\t\t\t\t\t\t\trej(\n\t\t\t\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t\t\t\t`Session is invalid due to: ${err.message} and failed to clean up invalid session: ${cleanUpError.message}`\n\t\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\trej(err);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tlogger.debug('Succeed to get the user session', session);\n\t\t\t\t\t\t\t\tres(session);\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\t{ clientMetadata }\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t\tthis.inflightSessionPromiseCounter++;\n\n\t\ttry {\n\t\t\tconst userSession = await this.inflightSessionPromise;\n\t\t\t// Set private member. Avoid user.setSignInUserSession() to prevent excessive localstorage refresh.\n\t\t\t// @ts-ignore\n\t\t\tuser.signInUserSession = userSession;\n\t\t\treturn userSession!;\n\t\t} finally {\n\t\t\tthis.inflightSessionPromiseCounter--;\n\t\t}\n\t}\n\n\t/**\n\t * Get the corresponding user session\n\t * @param {Object} user - The CognitoUser object\n\t * @return - A promise resolves to the session\n\t */\n\tpublic userSession(user): Promise<CognitoUserSession> {\n\t\treturn this._userSession(user);\n\t}\n\n\t/**\n\t * Get authenticated credentials of current user.\n\t * @return - A promise resolves to be current user's credentials\n\t */\n\tpublic async currentUserCredentials(): Promise<ICredentials> {\n\t\tlogger.debug('Getting current user credentials');\n\n\t\ttry {\n\t\t\tawait this._storageSync;\n\t\t} catch (e) {\n\t\t\tlogger.debug('Failed to sync cache info into memory', e);\n\t\t\tthrow e;\n\t\t}\n\n\t\t// first to check whether there is federation info in the auth storage\n\t\tlet federatedInfo = null;\n\t\ttry {\n\t\t\tfederatedInfo = JSON.parse(\n\t\t\t\tthis._storage.getItem('aws-amplify-federatedInfo')\n\t\t\t);\n\t\t} catch (e) {\n\t\t\tlogger.debug('failed to get or parse item aws-amplify-federatedInfo', e);\n\t\t}\n\n\t\tif (federatedInfo) {\n\t\t\t// refresh the jwt token here if necessary\n\t\t\treturn this.Credentials.refreshFederatedToken(federatedInfo);\n\t\t} else {\n\t\t\treturn this.currentSession()\n\t\t\t\t.then(session => {\n\t\t\t\t\tlogger.debug('getting session success', session);\n\t\t\t\t\treturn this.Credentials.set(session, 'session');\n\t\t\t\t})\n\t\t\t\t.catch(() => {\n\t\t\t\t\tlogger.debug('getting guest credentials');\n\t\t\t\t\treturn this.Credentials.set(null, 'guest');\n\t\t\t\t});\n\t\t}\n\t}\n\n\tpublic currentCredentials(): Promise<ICredentials> {\n\t\tlogger.debug('getting current credentials');\n\t\treturn this.Credentials.get();\n\t}\n\n\t/**\n\t * Initiate an attribute confirmation request\n\t * @param {Object} user - The CognitoUser\n\t * @param {Object} attr - The attributes to be verified\n\t * @return - A promise resolves to callback data if success\n\t */\n\tpublic verifyUserAttribute(\n\t\tuser: CognitoUser | any,\n\t\tattr: string,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<void> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.getAttributeVerificationCode(\n\t\t\t\tattr,\n\t\t\t\t{\n\t\t\t\t\tonSuccess(success) {\n\t\t\t\t\t\treturn resolve(success);\n\t\t\t\t\t},\n\t\t\t\t\tonFailure(err) {\n\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Confirm an attribute using a confirmation code\n\t * @param {Object} user - The CognitoUser\n\t * @param {Object} attr - The attribute to be verified\n\t * @param {String} code - The confirmation code\n\t * @return - A promise resolves to callback data if success\n\t */\n\tpublic verifyUserAttributeSubmit(\n\t\tuser: CognitoUser | any,\n\t\tattr: string,\n\t\tcode: string\n\t): Promise<string> {\n\t\tif (!code) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyCode);\n\t\t}\n\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.verifyAttribute(attr, code, {\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tresolve(data);\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t\tonFailure(err) {\n\t\t\t\t\treject(err);\n\t\t\t\t\treturn;\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic verifyCurrentUserAttribute(attr: string): Promise<void> {\n\t\tconst that = this;\n\t\treturn that\n\t\t\t.currentUserPoolUser()\n\t\t\t.then(user => that.verifyUserAttribute(user, attr));\n\t}\n\n\t/**\n\t * Confirm current user's attribute using a confirmation code\n\t * @param {Object} attr - The attribute to be verified\n\t * @param {String} code - The confirmation code\n\t * @return - A promise resolves to callback data if success\n\t */\n\tverifyCurrentUserAttributeSubmit(\n\t\tattr: string,\n\t\tcode: string\n\t): Promise<string> {\n\t\tconst that = this;\n\t\treturn that\n\t\t\t.currentUserPoolUser()\n\t\t\t.then(user => that.verifyUserAttributeSubmit(user, attr, code));\n\t}\n\n\tprivate async cognitoIdentitySignOut(\n\t\topts: SignOutOpts,\n\t\tuser: CognitoUser | any\n\t) {\n\t\ttry {\n\t\t\tawait this._storageSync;\n\t\t} catch (e) {\n\t\t\tlogger.debug('Failed to sync cache info into memory', e);\n\t\t\tthrow e;\n\t\t}\n\n\t\tconst isSignedInHostedUI =\n\t\t\tthis._oAuthHandler &&\n\t\t\tthis._storage.getItem('amplify-signin-with-hostedUI') === 'true';\n\n\t\treturn new Promise((res, rej) => {\n\t\t\tif (opts && opts.global) {\n\t\t\t\tlogger.debug('user global sign out', user);\n\t\t\t\t// in order to use global signout\n\t\t\t\t// we must validate the user as an authenticated user by using getSession\n\t\t\t\tconst clientMetadata = this._config.clientMetadata; // TODO: verify behavior if this is override during signIn\n\n\t\t\t\tuser.getSession(\n\t\t\t\t\tasync (err, result) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tlogger.debug('failed to get the user session', err);\n\t\t\t\t\t\t\tif (this.isSessionInvalid(err)) {\n\t\t\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\t\t\tawait this.cleanUpInvalidSession(user);\n\t\t\t\t\t\t\t\t} catch (cleanUpError) {\n\t\t\t\t\t\t\t\t\trej(\n\t\t\t\t\t\t\t\t\t\tnew Error(\n\t\t\t\t\t\t\t\t\t\t\t`Session is invalid due to: ${err.message} and failed to clean up invalid session: ${cleanUpError.message}`\n\t\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn rej(err);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tuser.globalSignOut({\n\t\t\t\t\t\t\tonSuccess: data => {\n\t\t\t\t\t\t\t\tlogger.debug('global sign out success');\n\t\t\t\t\t\t\t\tif (isSignedInHostedUI) {\n\t\t\t\t\t\t\t\t\tthis.oAuthSignOutRedirect(res, rej);\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn res();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tonFailure: err => {\n\t\t\t\t\t\t\t\tlogger.debug('global sign out failed', err);\n\t\t\t\t\t\t\t\treturn rej(err);\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\t{ clientMetadata }\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tlogger.debug('user sign out', user);\n\t\t\t\tuser.signOut(() => {\n\t\t\t\t\tif (isSignedInHostedUI) {\n\t\t\t\t\t\tthis.oAuthSignOutRedirect(res, rej);\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn res();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tprivate oAuthSignOutRedirect(\n\t\tresolve: () => void,\n\t\treject: (reason?: any) => void\n\t) {\n\t\tconst { isBrowser } = browserOrNode();\n\n\t\tif (isBrowser) {\n\t\t\tthis.oAuthSignOutRedirectOrReject(reject);\n\t\t} else {\n\t\t\tthis.oAuthSignOutAndResolve(resolve);\n\t\t}\n\t}\n\n\tprivate oAuthSignOutAndResolve(resolve: () => void) {\n\t\tthis._oAuthHandler.signOut();\n\t\tresolve();\n\t}\n\n\tprivate oAuthSignOutRedirectOrReject(reject: (reason?: any) => void) {\n\t\tthis._oAuthHandler.signOut(); // this method redirects url\n\n\t\t// App should be redirected to another url otherwise it will reject\n\t\tsetTimeout(() => reject(Error('Signout timeout fail')), 3000);\n\t}\n\n\t/**\n\t * Sign out method\n\t * @\n\t * @return - A promise resolved if success\n\t */\n\tpublic async signOut(opts: SignOutOpts = {}): Promise<any> {\n\t\ttry {\n\t\t\tawait this.cleanCachedItems();\n\t\t} catch (e) {\n\t\t\tlogger.debug('failed to clear cached items');\n\t\t}\n\n\t\tif (this.userPool) {\n\t\t\ttry {\n\t\t\t\tawait this._storageSync;\n\t\t\t} catch (e) {\n\t\t\t\tlogger.debug('Failed to sync cache info into memory', e);\n\t\t\t\tthrow e;\n\t\t\t}\n\t\t\tconst user = this.userPool.getCurrentUser();\n\t\t\tif (user) {\n\t\t\t\tawait this.cognitoIdentitySignOut(opts, user);\n\t\t\t} else {\n\t\t\t\tlogger.debug('no current Cognito user');\n\t\t\t}\n\t\t} else {\n\t\t\tlogger.debug('no Cognito User pool');\n\t\t}\n\n\t\t/**\n\t\t * Note for future refactor - no reliable way to get username with\n\t\t * Cognito User Pools vs Identity when federating with Social Providers\n\t\t * This is why we need a well structured session object that can be inspected\n\t\t * and information passed back in the message below for Hub dispatch\n\t\t */\n\t\tdispatchAuthEvent('signOut', this.user, `A user has been signed out`);\n\t\tthis.user = null;\n\t}\n\n\tprivate async cleanCachedItems() {\n\t\t// clear cognito cached item\n\t\tawait this.Credentials.clear();\n\t}\n\n\t/**\n\t * Change a password for an authenticated user\n\t * @param {Object} user - The CognitoUser object\n\t * @param {String} oldPassword - the current password\n\t * @param {String} newPassword - the requested new password\n\t * @return - A promise resolves if success\n\t */\n\tpublic changePassword(\n\t\tuser: CognitoUser | any,\n\t\toldPassword: string,\n\t\tnewPassword: string,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<'SUCCESS'> {\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tthis.userSession(user).then(session => {\n\t\t\t\tuser.changePassword(\n\t\t\t\t\toldPassword,\n\t\t\t\t\tnewPassword,\n\t\t\t\t\t(err, data) => {\n\t\t\t\t\t\tif (err) {\n\t\t\t\t\t\t\tlogger.debug('change password failure', err);\n\t\t\t\t\t\t\treturn reject(err);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn resolve(data);\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tclientMetadata\n\t\t\t\t);\n\t\t\t});\n\t\t});\n\t}\n\n\t/**\n\t * Initiate a forgot password request\n\t * @param {String} username - the username to change password\n\t * @return - A promise resolves if success\n\t */\n\tpublic forgotPassword(\n\t\tusername: string,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<any> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\t\tif (!username) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n\t\t}\n\n\t\tconst user = this.createCognitoUser(username);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.forgotPassword(\n\t\t\t\t{\n\t\t\t\t\tonSuccess: () => {\n\t\t\t\t\t\tresolve();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t},\n\t\t\t\t\tonFailure: err => {\n\t\t\t\t\t\tlogger.debug('forgot password failure', err);\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'forgotPassword_failure',\n\t\t\t\t\t\t\terr,\n\t\t\t\t\t\t\t`${username} forgotPassword failed`\n\t\t\t\t\t\t);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t},\n\t\t\t\t\tinputVerificationCode: data => {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'forgotPassword',\n\t\t\t\t\t\t\tuser,\n\t\t\t\t\t\t\t`${username} has initiated forgot password flow`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tresolve(data);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Confirm a new password using a confirmation Code\n\t * @param {String} username - The username\n\t * @param {String} code - The confirmation code\n\t * @param {String} password - The new password\n\t * @return - A promise that resolves if success\n\t */\n\tpublic forgotPasswordSubmit(\n\t\tusername: string,\n\t\tcode: string,\n\t\tpassword: string,\n\t\tclientMetadata: ClientMetaData = this._config.clientMetadata\n\t): Promise<string> {\n\t\tif (!this.userPool) {\n\t\t\treturn this.rejectNoUserPool();\n\t\t}\n\t\tif (!username) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyUsername);\n\t\t}\n\t\tif (!code) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyCode);\n\t\t}\n\t\tif (!password) {\n\t\t\treturn this.rejectAuthError(AuthErrorTypes.EmptyPassword);\n\t\t}\n\n\t\tconst user = this.createCognitoUser(username);\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tuser.confirmPassword(\n\t\t\t\tcode,\n\t\t\t\tpassword,\n\t\t\t\t{\n\t\t\t\t\tonSuccess: success => {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'forgotPasswordSubmit',\n\t\t\t\t\t\t\tuser,\n\t\t\t\t\t\t\t`${username} forgotPasswordSubmit successful`\n\t\t\t\t\t\t);\n\t\t\t\t\t\tresolve(success);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t},\n\t\t\t\t\tonFailure: err => {\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'forgotPasswordSubmit_failure',\n\t\t\t\t\t\t\terr,\n\t\t\t\t\t\t\t`${username} forgotPasswordSubmit failed`\n\t\t\t\t\t\t);\n\t\t\t\t\t\treject(err);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tclientMetadata\n\t\t\t);\n\t\t});\n\t}\n\n\t/**\n\t * Get user information\n\t * @async\n\t * @return {Object }- current User's information\n\t */\n\tpublic async currentUserInfo() {\n\t\tconst source = this.Credentials.getCredSource();\n\n\t\tif (!source || source === 'aws' || source === 'userPool') {\n\t\t\tconst user = await this.currentUserPoolUser().catch(err =>\n\t\t\t\tlogger.error(err)\n\t\t\t);\n\t\t\tif (!user) {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\ttry {\n\t\t\t\tconst attributes = await this.userAttributes(user);\n\t\t\t\tconst userAttrs: object = this.attributesToObject(attributes);\n\t\t\t\tlet credentials = null;\n\t\t\t\ttry {\n\t\t\t\t\tcredentials = await this.currentCredentials();\n\t\t\t\t} catch (e) {\n\t\t\t\t\tlogger.debug(\n\t\t\t\t\t\t'Failed to retrieve credentials while getting current user info',\n\t\t\t\t\t\te\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\tconst info = {\n\t\t\t\t\tid: credentials ? credentials.identityId : undefined,\n\t\t\t\t\tusername: user.getUsername(),\n\t\t\t\t\tattributes: userAttrs,\n\t\t\t\t};\n\t\t\t\treturn info;\n\t\t\t} catch (err) {\n\t\t\t\tlogger.error('currentUserInfo error', err);\n\t\t\t\treturn {};\n\t\t\t}\n\t\t}\n\n\t\tif (source === 'federated') {\n\t\t\tconst user = this.user;\n\t\t\treturn user ? user : {};\n\t\t}\n\t}\n\n\tpublic async federatedSignIn(\n\t\toptions?: FederatedSignInOptions\n\t): Promise<ICredentials>;\n\tpublic async federatedSignIn(\n\t\tprovider: LegacyProvider,\n\t\tresponse: FederatedResponse,\n\t\tuser: FederatedUser\n\t): Promise<ICredentials>;\n\tpublic async federatedSignIn(\n\t\toptions?: FederatedSignInOptionsCustom\n\t): Promise<ICredentials>;\n\tpublic async federatedSignIn(\n\t\tproviderOrOptions:\n\t\t\t| LegacyProvider\n\t\t\t| FederatedSignInOptions\n\t\t\t| FederatedSignInOptionsCustom,\n\t\tresponse?: FederatedResponse,\n\t\tuser?: FederatedUser\n\t): Promise<ICredentials> {\n\t\tif (!this._config.identityPoolId && !this._config.userPoolId) {\n\t\t\tthrow new Error(\n\t\t\t\t`Federation requires either a User Pool or Identity Pool in config`\n\t\t\t);\n\t\t}\n\n\t\t// Ensure backwards compatability\n\t\tif (typeof providerOrOptions === 'undefined') {\n\t\t\tif (this._config.identityPoolId && !this._config.userPoolId) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`Federation with Identity Pools requires tokens passed as arguments`\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tif (\n\t\t\tisFederatedSignInOptions(providerOrOptions) ||\n\t\t\tisFederatedSignInOptionsCustom(providerOrOptions) ||\n\t\t\thasCustomState(providerOrOptions) ||\n\t\t\ttypeof providerOrOptions === 'undefined'\n\t\t) {\n\t\t\tconst options = providerOrOptions || {\n\t\t\t\tprovider: CognitoHostedUIIdentityProvider.Cognito,\n\t\t\t};\n\t\t\tconst provider = isFederatedSignInOptions(options)\n\t\t\t\t? options.provider\n\t\t\t\t: (options as FederatedSignInOptionsCustom).customProvider;\n\n\t\t\tconst customState = isFederatedSignInOptions(options)\n\t\t\t\t? options.customState\n\t\t\t\t: (options as FederatedSignInOptionsCustom).customState;\n\n\t\t\tif (this._config.userPoolId) {\n\t\t\t\tconst client_id = isCognitoHostedOpts(this._config.oauth)\n\t\t\t\t\t? this._config.userPoolWebClientId\n\t\t\t\t\t: this._config.oauth.clientID;\n\t\t\t\t/*Note: Invenstigate automatically adding trailing slash */\n\t\t\t\tconst redirect_uri = isCognitoHostedOpts(this._config.oauth)\n\t\t\t\t\t? this._config.oauth.redirectSignIn\n\t\t\t\t\t: this._config.oauth.redirectUri;\n\n\t\t\t\tthis._oAuthHandler.oauthSignIn(\n\t\t\t\t\tthis._config.oauth.responseType,\n\t\t\t\t\tthis._config.oauth.domain,\n\t\t\t\t\tredirect_uri,\n\t\t\t\t\tclient_id,\n\t\t\t\t\tprovider,\n\t\t\t\t\tcustomState\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tconst provider = providerOrOptions;\n\t\t\t// To check if the user is already logged in\n\t\t\ttry {\n\t\t\t\tconst loggedInUser = JSON.stringify(\n\t\t\t\t\tJSON.parse(this._storage.getItem('aws-amplify-federatedInfo')).user\n\t\t\t\t);\n\t\t\t\tif (loggedInUser) {\n\t\t\t\t\tlogger.warn(`There is already a signed in user: ${loggedInUser} in your app.\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tYou should not call Auth.federatedSignIn method again as it may cause unexpected behavior.`);\n\t\t\t\t}\n\t\t\t} catch (e) {}\n\n\t\t\tconst { token, identity_id, expires_at } = response;\n\t\t\t// Because this.Credentials.set would update the user info with identity id\n\t\t\t// So we need to retrieve the user again.\n\t\t\tconst credentials = await this.Credentials.set(\n\t\t\t\t{ provider, token, identity_id, user, expires_at },\n\t\t\t\t'federation'\n\t\t\t);\n\t\t\tconst currentUser = await this.currentAuthenticatedUser();\n\t\t\tdispatchAuthEvent(\n\t\t\t\t'signIn',\n\t\t\t\tcurrentUser,\n\t\t\t\t`A user ${currentUser.username} has been signed in`\n\t\t\t);\n\t\t\tlogger.debug('federated sign in credentials', credentials);\n\t\t\treturn credentials;\n\t\t}\n\t}\n\n\t/**\n\t * Used to complete the OAuth flow with or without the Cognito Hosted UI\n\t * @param {String} URL - optional parameter for customers to pass in the response URL\n\t */\n\tprivate async _handleAuthResponse(URL?: string) {\n\t\tif (this.oAuthFlowInProgress) {\n\t\t\tlogger.debug(`Skipping URL ${URL} current flow in progress`);\n\t\t\treturn;\n\t\t}\n\n\t\ttry {\n\t\t\tthis.oAuthFlowInProgress = true;\n\t\t\tif (!this._config.userPoolId) {\n\t\t\t\tthrow new Error(\n\t\t\t\t\t`OAuth responses require a User Pool defined in config`\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tdispatchAuthEvent(\n\t\t\t\t'parsingCallbackUrl',\n\t\t\t\t{ url: URL },\n\t\t\t\t`The callback url is being parsed`\n\t\t\t);\n\n\t\t\tconst currentUrl =\n\t\t\t\tURL || (browserOrNode().isBrowser ? window.location.href : '');\n\n\t\t\tconst hasCodeOrError = !!(parse(currentUrl).query || '')\n\t\t\t\t.split('&')\n\t\t\t\t.map(entry => entry.split('='))\n\t\t\t\t.find(([k]) => k === 'code' || k === 'error');\n\n\t\t\tconst hasTokenOrError = !!(parse(currentUrl).hash || '#')\n\t\t\t\t.substr(1)\n\t\t\t\t.split('&')\n\t\t\t\t.map(entry => entry.split('='))\n\t\t\t\t.find(([k]) => k === 'access_token' || k === 'error');\n\n\t\t\tif (hasCodeOrError || hasTokenOrError) {\n\t\t\t\tthis._storage.setItem('amplify-redirected-from-hosted-ui', 'true');\n\t\t\t\ttry {\n\t\t\t\t\tconst { accessToken, idToken, refreshToken, state } =\n\t\t\t\t\t\tawait this._oAuthHandler.handleAuthResponse(currentUrl);\n\t\t\t\t\tconst session = new CognitoUserSession({\n\t\t\t\t\t\tIdToken: new CognitoIdToken({ IdToken: idToken }),\n\t\t\t\t\t\tRefreshToken: new CognitoRefreshToken({\n\t\t\t\t\t\t\tRefreshToken: refreshToken,\n\t\t\t\t\t\t}),\n\t\t\t\t\t\tAccessToken: new CognitoAccessToken({\n\t\t\t\t\t\t\tAccessToken: accessToken,\n\t\t\t\t\t\t}),\n\t\t\t\t\t});\n\n\t\t\t\t\tlet credentials;\n\t\t\t\t\t// Get AWS Credentials & store if Identity Pool is defined\n\t\t\t\t\tif (this._config.identityPoolId) {\n\t\t\t\t\t\tcredentials = await this.Credentials.set(session, 'session');\n\t\t\t\t\t\tlogger.debug('AWS credentials', credentials);\n\t\t\t\t\t}\n\n\t\t\t\t\t/*\n\t\t\t\tPrior to the request we do sign the custom state along with the state we set. This check will verify\n\t\t\t\tif there is a dash indicated when setting custom state from the request. If a dash is contained\n\t\t\t\tthen there is custom state present on the state string.\n\t\t\t\t*/\n\t\t\t\t\tconst isCustomStateIncluded = /-/.test(state);\n\n\t\t\t\t\t/*\n\t\t\t\tThe following is to create a user for the Cognito Identity SDK to store the tokens\n\t\t\t\tWhen we remove this SDK later that logic will have to be centralized in our new version\n\t\t\t\t*/\n\t\t\t\t\t//#region\n\t\t\t\t\tconst currentUser = this.createCognitoUser(\n\t\t\t\t\t\tsession.getIdToken().decodePayload()['cognito:username']\n\t\t\t\t\t);\n\n\t\t\t\t\t// This calls cacheTokens() in Cognito SDK\n\t\t\t\t\tcurrentUser.setSignInUserSession(session);\n\n\t\t\t\t\tif (window && typeof window.history !== 'undefined') {\n\t\t\t\t\t\twindow.history.replaceState(\n\t\t\t\t\t\t\twindow.history.state,\n\t\t\t\t\t\t\t'',\n\t\t\t\t\t\t\t(this._config.oauth as AwsCognitoOAuthOpts).redirectSignIn\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t'signIn',\n\t\t\t\t\t\tcurrentUser,\n\t\t\t\t\t\t`A user ${currentUser.getUsername()} has been signed in`\n\t\t\t\t\t);\n\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t'cognitoHostedUI',\n\t\t\t\t\t\tcurrentUser,\n\t\t\t\t\t\t`A user ${currentUser.getUsername()} has been signed in via Cognito Hosted UI`\n\t\t\t\t\t);\n\n\t\t\t\t\tif (isCustomStateIncluded) {\n\t\t\t\t\t\tconst customState = state.split('-').splice(1).join('-');\n\n\t\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t\t'customOAuthState',\n\t\t\t\t\t\t\turlSafeDecode(customState),\n\t\t\t\t\t\t\t`State for user ${currentUser.getUsername()}`\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\t//#endregion\n\n\t\t\t\t\treturn credentials;\n\t\t\t\t} catch (err) {\n\t\t\t\t\tlogger.debug('Error in cognito hosted auth response', err);\n\n\t\t\t\t\t// Just like a successful handling of `?code`, replace the window history to \"dispose\" of the `code`.\n\t\t\t\t\t// Otherwise, reloading the page will throw errors as the `code` has already been spent.\n\t\t\t\t\tif (window && typeof window.history !== 'undefined') {\n\t\t\t\t\t\twindow.history.replaceState(\n\t\t\t\t\t\t\twindow.history.state,\n\t\t\t\t\t\t\t'',\n\t\t\t\t\t\t\t(this._config.oauth as AwsCognitoOAuthOpts).redirectSignIn\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t'signIn_failure',\n\t\t\t\t\t\terr,\n\t\t\t\t\t\t`The OAuth response flow failed`\n\t\t\t\t\t);\n\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t'cognitoHostedUI_failure',\n\t\t\t\t\t\terr,\n\t\t\t\t\t\t`A failure occurred when returning to the Cognito Hosted UI`\n\t\t\t\t\t);\n\t\t\t\t\tdispatchAuthEvent(\n\t\t\t\t\t\t'customState_failure',\n\t\t\t\t\t\terr,\n\t\t\t\t\t\t`A failure occurred when returning state`\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t} finally {\n\t\t\tthis.oAuthFlowInProgress = false;\n\t\t}\n\t}\n\n\t/**\n\t * Compact version of credentials\n\t * @param {Object} credentials\n\t * @return {Object} - Credentials\n\t */\n\tpublic essentialCredentials(credentials): ICredentials {\n\t\treturn {\n\t\t\taccessKeyId: credentials.accessKeyId,\n\t\t\tsessionToken: credentials.sessionToken,\n\t\t\tsecretAccessKey: credentials.secretAccessKey,\n\t\t\tidentityId: credentials.identityId,\n\t\t\tauthenticated: credentials.authenticated,\n\t\t};\n\t}\n\n\tprivate attributesToObject(attributes) {\n\t\tconst obj = {};\n\t\tif (attributes) {\n\t\t\tattributes.map(attribute => {\n\t\t\t\tif (\n\t\t\t\t\tattribute.Name === 'email_verified' ||\n\t\t\t\t\tattribute.Name === 'phone_number_verified'\n\t\t\t\t) {\n\t\t\t\t\tobj[attribute.Name] =\n\t\t\t\t\t\tthis.isTruthyString(attribute.Value) || attribute.Value === true;\n\t\t\t\t} else {\n\t\t\t\t\tobj[attribute.Name] = attribute.Value;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\treturn obj;\n\t}\n\n\tprivate isTruthyString(value: any): boolean {\n\t\treturn (\n\t\t\ttypeof value.toLowerCase === 'function' && value.toLowerCase() === 'true'\n\t\t);\n\t}\n\n\tprivate createCognitoUser(username: string): CognitoUser {\n\t\tconst userData: ICognitoUserData = {\n\t\t\tUsername: username,\n\t\t\tPool: this.userPool,\n\t\t};\n\t\tuserData.Storage = this._storage;\n\n\t\tconst { authenticationFlowType } = this._config;\n\n\t\tconst user = new CognitoUser(userData);\n\t\tif (authenticationFlowType) {\n\t\t\tuser.setAuthenticationFlowType(authenticationFlowType);\n\t\t}\n\t\treturn user;\n\t}\n\n\tprivate _isValidAuthStorage(obj) {\n\t\t// We need to check if the obj has the functions of Storage\n\t\treturn (\n\t\t\t!!obj &&\n\t\t\ttypeof obj.getItem === 'function' &&\n\t\t\ttypeof obj.setItem === 'function' &&\n\t\t\ttypeof obj.removeItem === 'function' &&\n\t\t\ttypeof obj.clear === 'function'\n\t\t);\n\t}\n\n\tprivate noUserPoolErrorHandler(config: AuthOptions): AuthErrorTypes {\n\t\tif (config) {\n\t\t\tif (!config.userPoolId || !config.identityPoolId) {\n\t\t\t\treturn AuthErrorTypes.MissingAuthConfig;\n\t\t\t}\n\t\t}\n\t\treturn AuthErrorTypes.NoConfig;\n\t}\n\n\tprivate rejectAuthError(type: AuthErrorTypes): Promise<never> {\n\t\treturn Promise.reject(new AuthError(type));\n\t}\n\n\tprivate rejectNoUserPool(): Promise<never> {\n\t\tconst type = this.noUserPoolErrorHandler(this._config);\n\t\treturn Promise.reject(new NoUserPoolError(type));\n\t}\n\n\tpublic async rememberDevice(): Promise<string | AuthError> {\n\t\tlet currUser;\n\n\t\ttry {\n\t\t\tcurrUser = await this.currentUserPoolUser();\n\t\t} catch (error) {\n\t\t\tlogger.debug('The user is not authenticated by the error', error);\n\t\t\treturn Promise.reject('The user is not authenticated');\n\t\t}\n\n\t\tcurrUser.getCachedDeviceKeyAndPassword();\n\t\treturn new Promise((res, rej) => {\n\t\t\tcurrUser.setDeviceStatusRemembered({\n\t\t\t\tonSuccess: data => {\n\t\t\t\t\tres(data);\n\t\t\t\t},\n\t\t\t\tonFailure: err => {\n\t\t\t\t\tif (err.code === 'InvalidParameterException') {\n\t\t\t\t\t\trej(new AuthError(AuthErrorTypes.DeviceConfig));\n\t\t\t\t\t} else if (err.code === 'NetworkError') {\n\t\t\t\t\t\trej(new AuthError(AuthErrorTypes.NetworkError));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trej(err);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic async forgetDevice(): Promise<void> {\n\t\tlet currUser;\n\n\t\ttry {\n\t\t\tcurrUser = await this.currentUserPoolUser();\n\t\t} catch (error) {\n\t\t\tlogger.debug('The user is not authenticated by the error', error);\n\t\t\treturn Promise.reject('The user is not authenticated');\n\t\t}\n\n\t\tcurrUser.getCachedDeviceKeyAndPassword();\n\t\treturn new Promise((res, rej) => {\n\t\t\tcurrUser.forgetDevice({\n\t\t\t\tonSuccess: data => {\n\t\t\t\t\tres(data);\n\t\t\t\t},\n\t\t\t\tonFailure: err => {\n\t\t\t\t\tif (err.code === 'InvalidParameterException') {\n\t\t\t\t\t\trej(new AuthError(AuthErrorTypes.DeviceConfig));\n\t\t\t\t\t} else if (err.code === 'NetworkError') {\n\t\t\t\t\t\trej(new AuthError(AuthErrorTypes.NetworkError));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trej(err);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t});\n\t\t});\n\t}\n\n\tpublic async fetchDevices(): Promise<IAuthDevice[]> {\n\t\tlet currUser;\n\n\t\ttry {\n\t\t\tcurrUser = await this.currentUserPoolUser();\n\t\t} catch (error) {\n\t\t\tlogger.debug('The user is not authenticated by the error', error);\n\t\t\tthrow new Error('The user is not authenticated');\n\t\t}\n\n\t\tcurrUser.getCachedDeviceKeyAndPassword();\n\t\treturn new Promise((res, rej) => {\n\t\t\tconst cb = {\n\t\t\t\tonSuccess(data) {\n\t\t\t\t\tconst deviceList: IAuthDevice[] = data.Devices.map(device => {\n\t\t\t\t\t\tconst deviceName =\n\t\t\t\t\t\t\tdevice.DeviceAttributes.find(\n\t\t\t\t\t\t\t\t({ Name }) => Name === 'device_name'\n\t\t\t\t\t\t\t) || {};\n\n\t\t\t\t\t\tconst deviceInfo: IAuthDevice = {\n\t\t\t\t\t\t\tid: device.DeviceKey,\n\t\t\t\t\t\t\tname: deviceName.Value,\n\t\t\t\t\t\t};\n\t\t\t\t\t\treturn deviceInfo;\n\t\t\t\t\t});\n\t\t\t\t\tres(deviceList);\n\t\t\t\t},\n\t\t\t\tonFailure: err => {\n\t\t\t\t\tif (err.code === 'InvalidParameterException') {\n\t\t\t\t\t\trej(new AuthError(AuthErrorTypes.DeviceConfig));\n\t\t\t\t\t} else if (err.code === 'NetworkError') {\n\t\t\t\t\t\trej(new AuthError(AuthErrorTypes.NetworkError));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trej(err);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t};\n\t\t\tcurrUser.listDevices(MAX_DEVICES, null, cb);\n\t\t});\n\t}\n}\n\nexport const Auth = new AuthClass(null);\n\nAmplify.register(Auth);\n"],"names":[],"mappings":"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"}}]
}